<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graphics Studio - Premium Design Services</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Geologica:wght@100..900&family=Libertinus+Math&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4a90e2;
            --primary-gradient: linear-gradient(135deg, #4a90e2, #6bb6ff);
            --secondary-color: #6bb6ff;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --dark-bg: #0A0A0A;
            --card-bg: rgba(255, 255, 255, 0.02);
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b3d9ff;
            --text-muted: #999999;
        }

        body {
            font-family: 'Geologica', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #6bb6ff, #89c4ff);
        }

        /* Background Animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(16, 16, 16, 0.8) 0%, transparent 70%),
                radial-gradient(circle at 80% 20%, rgba(20, 20, 20, 0.6) 0%, transparent 70%),
                radial-gradient(circle at 40% 80%, rgba(18, 18, 18, 0.7) 0%, transparent 70%);
            pointer-events: none;
            z-index: -1;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            transition: all 0.3s ease;
        }

        .header.scrolled {
 
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
        }

.logo {
   display: flex;
   align-items: center;
   gap: 0.75rem;
   font-size: 1.5rem;
   font-weight: 700;
   color: var(--text-primary);
   text-decoration: none;
   height: 60px;
   margin-left: -5.7rem; /* Przesuwa w lewo */
   margin-top: 0.40rem; /* Przesuwa w górę */
}

        .logo img {
            height: 120px !important;
            width: auto !important;
            margin: -10px 0;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2.5rem;
            margin: 0;
            padding: 0;
            position: absolute;
            left: 35%;
            transform: translateX(-50%);
        }

        .nav-link {
            color: #94a3b8;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
            transition: color 0.3s ease;
            position: relative;
            padding: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #ffffff;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: #60a5fa;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after,
        .nav-link.active::after {
            width: 100%;
        }

        .nav-icon {
            width: 16px;
            height: 16px;
            fill: currentColor;
        }

.auth-buttons {
    display: flex;
    gap: 1rem;
    align-items: center;
    margin-left: auto;
    margin-right: -2rem; /* DODAJ tę linię */
}

        #loginButtons {
    display: flex;
    gap: 1rem;
    align-items: center;

}

        .search-container {
            position: relative;
            margin-right: 1rem;
        }

        .search-input {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(71, 85, 105, 0.5);
            border-radius: 6px;
            padding: 0.6rem 1rem 0.6rem 2.5rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            width: 250px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #60a5fa;
            background: rgba(30, 41, 59, 0.8);
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        .search-input::placeholder {
            color: #64748b;
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: #60a5fa;
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(96, 165, 250, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: #60a5fa;
            border: 2px solid #60a5fa;
        }

        .btn-outline:hover {
            background: #60a5fa;
            color: white;
        }

        /* Hero Section */
        .hero {
            padding: 0;
            text-align: center;
            background: #1e293b;
            position: relative;
            min-height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: url('https://media.discordapp.net/attachments/1383219777841135807/1398474553596055703/5345435.png?ex=68857e6b&is=68842ceb&hm=e18df24b4b5b5f4412c96e481eee6056caf4dd7cd03a7e4b9b4dfaee01b50b1c&=&format=webp&quality=lossless&width=1872&height=405');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;

            z-index: 1;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
            padding: 2rem;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            color: #ffffff;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: #cbd5e1;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .hero-buttons .btn {
            padding: 1rem 2rem;
            font-size: 1rem;
            border-radius: 8px;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #ffffff, #b3d9ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            text-align: center;
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Products Section */
        .products-section {
            padding: 5rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .product-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            height: 450px;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary-color);
            box-shadow: 0 20px 40px rgba(74, 144, 226, 0.3);
        }

        .product-image {
            height: 200px;
            overflow: hidden;
            position: relative;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(74, 144, 226, 0.8), rgba(107, 182, 255, 0.6));
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product-card:hover .product-overlay {
            opacity: 1;
        }

        .product-overlay i {
            font-size: 3rem;
            color: white;
            transition: transform 0.3s ease;
        }

        .product-card:hover .product-overlay i {
            transform: scale(1.2);
        }

        /* Benefits Section */
        .benefits-section {
            padding: 5rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .benefit-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .benefit-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 15px 30px rgba(74, 144, 226, 0.2);
        }

        .benefit-icon {
            width: 70px;
            height: 70px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 2rem;
            color: white;
            transition: all 0.3s ease;
        }

        .benefit-card:hover .benefit-icon {
            transform: scale(1.2) rotate(10deg);
            box-shadow: 0 10px 25px rgba(74, 144, 226, 0.4);
        }

        .benefit-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .benefit-description {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* FAQ Section */
        .faq-section {
            padding: 5rem 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .faq-container {
            margin-top: 3rem;
        }

        .faq-item {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            border-color: var(--primary-color);
        }

        .faq-question {
            padding: 1.5rem 2rem;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .faq-question:hover {
            color: var(--primary-color);
        }

        .faq-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 0 2rem;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .faq-item.active .faq-answer {
            padding: 0 2rem 1.5rem;
            max-height: 200px;
        }

        .faq-answer p {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Footer */
        .footer {
            background: var(--card-bg);
            border-top: 2px solid var(--border-color);
            padding: 3rem 2rem 2rem;
            margin-top: 5rem;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section h3 {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .footer-section p,
        .footer-section a {
            color: var(--text-secondary);
            line-height: 1.6;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--primary-color);
        }

        .footer-links {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-social {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .footer-social a {
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .footer-social a:hover {
            transform: translateY(-3px);
        }

        .footer-bottom {
            border-top: 1px solid var(--border-color);
            margin-top: 2rem;
            padding-top: 2rem;
            text-align: center;
            color: var(--text-muted);
        }

        /* Support Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10003;
        }

        .chat-button {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #5B9CFF, #4A8CE7);
            border: none;
            border-radius: 36px;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(74, 140, 231, 0.4);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(74, 140, 231, 0.6);
        }

        .chat-notification {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #ef4444;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            animation: notificationBounce 2s ease-in-out infinite;
        }

        @keyframes notificationBounce {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        .chat-panel {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 380px;
            height: 500px;
            background: #1a1a1a;
            border: none;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-panel.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .chat-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, #5B9CFF, #4A8CE7);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: white;
            border-radius: 20px 20px 0 0;
        }

        .chat-header-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .chat-header-text h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin: 0;
        }

        .chat-header-text p {
            font-size: 0.85rem;
            margin: 0;
            opacity: 0.9;
        }

        .chat-close {
            margin-left: auto;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .chat-close:hover {
            opacity: 0.7;
        }

        .chat-content {
            padding: 1.5rem;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            background: #1a1a1a;
        }

        .chat-intro {
            margin-bottom: 1.5rem;
        }

        .chat-intro h4 {
            color: white;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
        }

        .chat-intro p {
            color: #888;
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .chat-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .chat-option {
            background: #2a2a2a;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 1rem;
            color: white;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .chat-option:hover {
            background: #333;
            border-color: #5B9CFF;
        }

        .chat-option-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #5B9CFF, #4A8CE7);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }

        .chat-option-text {
            flex: 1;
        }

        .chat-option-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: white;
            font-size: 0.95rem;
        }

        .chat-option-desc {
            font-size: 0.8rem;
            color: #888;
            line-height: 1.3;
        }

        .chat-messages {
            display: none;
            flex-direction: column;
            gap: 1rem;
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .chat-message {
            display: flex;
            gap: 0.75rem;
            animation: messageSlide 0.3s ease-out;
        }

        .chat-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #5B9CFF, #4A8CE7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            flex-shrink: 0;
            font-size: 0.85rem;
        }

        .chat-bubble {
            background: #2a2a2a;
            border: 1px solid #333;
            border-radius: 12px 12px 12px 4px;
            padding: 0.75rem;
            color: white;
            max-width: 280px;
            position: relative;
            line-height: 1.4;
            font-size: 0.9rem;
        }

        .chat-time {
            font-size: 0.7rem;
            color: #666;
            margin-top: 0.5rem;
            text-align: left;
        }

        .chat-input-area {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color);
            display: none;
        }

        .chat-input-container {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            font-size: 0.9rem;
            resize: none;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: var(--primary-color);
        }

        .chat-send {
            background: var(--primary-gradient);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-send:hover {
            transform: scale(1.1);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .typing-dots {
            display: flex;
            gap: 3px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: #5B9CFF;
            border-radius: 50%;
            animation: typingDots 1.5s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDots {
            0%, 60%, 100% {
                transform: scale(1);
                opacity: 0.5;
            }
            30% {
                transform: scale(1.3);
                opacity: 1;
            }
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Responsive chat widget */
        @media (max-width: 768px) {
            .chat-panel {
                width: 350px;
                height: 480px;
                right: 0;
            }
            
            .chat-widget {
                right: 20px;
            }
        }

        .product-content {
            padding: 2rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .product-description {
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 1.5rem;
            flex-grow: 1;
            font-size: 0.85rem;
        }

        .product-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
        }

        .product-actions {
            display: flex;
            gap: 0.75rem;
        }

        .btn-product {
            padding: 0.75rem 1rem;
            border-radius: 10px;
            font-weight: 600;
            text-decoration: none;
            text-align: center;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            border: none;
            cursor: pointer;
        }

        .btn-product-primary {
            background: var(--primary-gradient);
            color: white;
            flex: 6; /* Made even wider */
        }

        .btn-product-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.4);
        }

        .btn-product-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-product-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Portfolio Modal */
        .portfolio-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .portfolio-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .portfolio-content {
            background: var(--dark-bg);
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 85vh;
            padding: 2rem;
            position: relative;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.3s ease;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .portfolio-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 1rem;
            flex-wrap: wrap;
        }

        .portfolio-tab {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            flex: 1;
            text-align: center;
            min-width: 120px;
        }

        .portfolio-tab.active {
            background: var(--primary-gradient);
            border-color: var(--primary-color);
            color: white;
        }

        .portfolio-tab:hover:not(.active) {
            border-color: var(--primary-color);
            color: var(--text-primary);
        }

        .portfolio-modal.active .portfolio-content {
            transform: translateY(0) scale(1);
        }

        .portfolio-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
            z-index: 10;
        }

        .portfolio-close:hover {
            color: var(--primary-color);
        }

        .portfolio-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
            color: var(--text-primary);
        }

        .portfolio-subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .portfolio-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .portfolio-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .portfolio-item:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }

        .portfolio-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .portfolio-item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(74, 144, 226, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }

        /* Image viewer modal */
        .image-viewer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10002;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .image-viewer.active {
            opacity: 1;
            visibility: visible;
        }

        .image-viewer img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .image-viewer-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .image-viewer-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .portfolio-item:hover .portfolio-item-overlay {
            opacity: 1;
        }

        .portfolio-item-overlay i {
            font-size: 2rem;
            color: white;
        }

        .portfolio-item-info {
            padding: 1rem;
        }

        .portfolio-item-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .portfolio-item-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Regular Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--dark-bg);
            border: 2px solid var(--primary-color);
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            position: relative;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0) scale(1);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--primary-color);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }


        /* Product Details Modal */
.product-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.product-modal.active {
    opacity: 1;
    visibility: visible;
}

.product-modal-content {
    background: var(--dark-bg);
    border: 2px solid var(--primary-color);
    border-radius: 20px;
    width: 95%;
    max-width: 1400px; /* Increased from 1200px */
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    transform: translateY(-20px) scale(0.95);
    transition: all 0.3s ease;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem; /* Increased from 3rem */
    padding: 4rem; /* Increased from 3rem */
}


.product-modal.active .product-modal-content {
    transform: translateY(0) scale(1);
}

.product-modal-close {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 2rem;
    cursor: pointer;
    transition: color 0.3s ease;
    z-index: 10;
}

.product-modal-close:hover {
    color: var(--primary-color);
}

.product-left {
    display: flex;
    flex-direction: column;
}

.product-modal-image {
    width: 100%;
    height: 400px;
    border-radius: 15px;
    overflow: hidden;
    margin-bottom: 2rem;
    border: 2px solid var(--border-color);
}

.product-modal-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.product-modal-description {
    color: var(--text-secondary);
    line-height: 1.6;
    font-size: 1.1rem;
    background: var(--card-bg);
    padding: 2rem;
    border-radius: 15px;
    border: 1px solid var(--border-color);
}


.product-modal-title {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 1rem;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.product-modal-price {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 2rem;
}


/* Payment Modal */
.payment-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10002;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.payment-modal.active {
    opacity: 1;
    visibility: visible;
}

.payment-modal-content {
    background: var(--dark-bg);
    border: 2px solid var(--primary-color);
    border-radius: 16px; /* zmniejszone z 20px */
    width: 90%; /* zmniejszone z 95% */
    max-width: 1200px; /* zmniejszone z 1400px */
    max-height: 85vh; /* zmniejszone z 90vh */
    overflow-y: auto;
    position: relative;
    transform: translateY(-20px) scale(0.95);
    transition: all 0.3s ease;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2.5rem; /* zmniejszone z 4rem */
    padding: 2.5rem; /* zmniejszone z 4rem */
}



.payment-modal.active .payment-modal-content {
    transform: translateY(0) scale(1);
}

.payment-left,
.payment-right {
    display: flex;
    flex-direction: column;
    gap: 1.5rem; /* zmniejszone z 2rem */
}

.payment-image {
    width: 100%;
    height: 220px; /* zmniejszone z 300px */
    border-radius: 12px; /* zmniejszone z 15px */
    overflow: hidden;
    border: 2px solid var(--border-color);
}

.payment-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.payment-description {
    color: var(--text-secondary);
    line-height: 1.5; /* zmniejszone z 1.6 */
    font-size: 0.9rem; /* zmniejszone z 1rem */
    background: var(--card-bg);
    padding: 1.5rem; /* zmniejszone z 2rem */
    border-radius: 12px; /* zmniejszone z 15px */
    border: 1px solid var(--border-color);
}


.payment-title {
    font-size: 1.6rem; /* zmniejszone z 2rem */
    font-weight: 800;
    color: var(--text-primary);
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.email-section,
.discount-section-payment,
.payment-method-section,
.delivery-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px; /* zmniejszone z 12px */
    padding: 1.2rem; /* zmniejszone z 1.5rem */
}


.section-title {
    font-size: 1rem; /* zmniejszone z 1.2rem */
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.8rem; /* zmniejszone z 1rem */
}

.email-input,
.discount-input-payment {
    width: 100%;
    padding: 0.6rem; /* zmniejszone z 0.75rem */
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 6px; /* zmniejszone z 8px */
    color: var(--text-primary);
    font-size: 0.9rem; /* zmniejszone z 1rem */
}


.calendar-container {
    margin-top: 0.8rem; /* zmniejszone z 1rem */
}


.calendar-header-nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem; /* zmniejszone z 1rem */
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 6px; /* zmniejszone z 8px */
    padding: 0.6rem; /* zmniejszone z 0.75rem */
}

.calendar-month-year {
    font-size: 0.9rem; /* zmniejszone z 1rem */
    font-weight: 600;
    color: var(--text-primary);
}

.calendar-nav-btn {
    background: var(--primary-gradient);
    border: none;
    border-radius: 6px;
    color: white;
    width: 32px;
    height: 32px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.calendar-nav-btn:hover {
    transform: scale(1.1);
}

.calendar-nav-btn:disabled {
    background: var(--text-muted);
    cursor: not-allowed;
    transform: none;
}

.calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.4rem; /* zmniejszone z 0.6rem */
    max-width: 420px; /* zmniejszone z 500px */
    width: 100%;
}

.calendar-header {
    text-align: center;
    font-weight: 600;
    color: var(--text-secondary);
    padding: 0.4rem; /* zmniejszone z 0.5rem */
    font-size: 0.8rem; /* zmniejszone z 0.9rem */
}

.calendar-day {
    aspect-ratio: 1;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px; /* zmniejszone z 8px */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.8rem; /* zmniejszone z 0.9rem */
    padding: 0.3rem; /* zmniejszone z 0.4rem */
    min-height: 40px; /* zmniejszone z 50px */
    color: var(--text-primary);
}

.calendar-day:hover:not(.disabled) {
    border-color: var(--primary-color);
    background: rgba(74, 144, 226, 0.2);
}

.calendar-day.disabled {
    background: rgba(0, 0, 0, 0.3); /* Ciemne tło dla niedostępnych */
    color: #555555; /* Ciemny tekst dla niedostępnych */
    cursor: not-allowed;
}


.calendar-day.other-month {
    display: none; /* UKRYJ inne miesiące */
}
.calendar-day.sunday {
    background: rgba(239, 68, 68, 0.2);
    border-color: #ef4444;
    color: #ef4444;
}

.calendar-day.selected {
    background: var(--primary-gradient);
    border-color: var(--primary-color);
    color: white;
}

.delivery-price {
    font-size: 0.65rem; /* zmniejszone z 0.75rem */
    color: var(--warning-color);
    font-weight: 600;
    margin-top: 2px; /* zmniejszone z 3px */
}

/* Price summary section */
.price-summary {
    background: var(--card-bg);
    border: 2px solid var(--primary-color);
    border-radius: 10px; /* zmniejszone z 12px */
    padding: 1.2rem; /* zmniejszone z 1.5rem */
    margin-top: 0.8rem; /* zmniejszone z 1rem */
}

.price-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.4rem; /* zmniejszone z 0.5rem */
    color: var(--text-secondary);
    font-size: 0.9rem; /* dodane */
}

.price-row.total {
    border-top: 1px solid var(--border-color);
    padding-top: 0.4rem; /* zmniejszone z 0.5rem */
    margin-top: 0.8rem; /* zmniejszone z 1rem */
    font-weight: 700;
    font-size: 1rem; /* zmniejszone z 1.2rem */
    color: var(--text-primary);
}

.price-value {
    color: var(--primary-color);
    font-weight: 600;
}

.price-value.total {
    color: var(--text-primary);
    font-size: 1.1rem; /* zmniejszone z 1.3rem */
}

.payment-methods {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.payment-method {
    background: var(--dark-bg);
    border: 2px solid var(--border-color);
    border-radius: 6px; /* zmniejszone z 8px */
    padding: 0.8rem; /* zmniejszone z 1rem */
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.8rem; /* zmniejszone z 1rem */
}
.payment-method:hover {
    border-color: var(--primary-color);
}

.payment-method.selected {
    border-color: var(--primary-color);
    background: rgba(74, 144, 226, 0.1);
}

.payment-method input[type="radio"] {
    margin: 0;
}

.payment-method-label {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem; /* dodane */
}

.payment-actions {
    display: flex;
    gap: 0.8rem; /* zmniejszone z 1rem */
    margin-top: 1.5rem; /* zmniejszone z 2rem */
}

/* Confirmation Modal */
.confirmation-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10003;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.confirmation-modal.active {
    opacity: 1;
    visibility: visible;
}

.confirmation-content {
    background: var(--dark-bg);
    border: 2px solid var(--primary-color);
    border-radius: 20px;
    width: 90%;
    max-width: 600px;
    padding: 3rem;
    text-align: center;
    position: relative;
    transform: translateY(-20px) scale(0.95);
    transition: all 0.3s ease;
}

.confirmation-modal.active .confirmation-content {
    transform: translateY(0) scale(1);
}

.confirmation-title {
    font-size: 2rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.payment-details {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 2rem;
    margin: 2rem 0;
    text-align: left;
}

.payment-address {
    background: var(--dark-bg);
    border: 1px solid var(--primary-color);
    border-radius: 8px;
    padding: 1rem;
    font-family: monospace;
    color: var(--primary-color);
    margin: 1rem 0;
    word-break: break-all;
}

.copy-button {
    background: var(--primary-gradient);
    border: none;
    border-radius: 6px;
    color: white;
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-size: 0.9rem;
    margin-left: 1rem;
}

.mark-paid-btn {
    background: var(--success-color);
    border: none;
    border-radius: 12px;
    color: white;
    padding: 1rem 2rem;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 2rem;
}

.mark-paid-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
}

@media (max-width: 768px) {
    .payment-modal-content {
        grid-template-columns: 1fr;
        gap: 2rem;
        padding: 2rem;
        margin: 1rem;
    }
}


.product-variants {
    margin-bottom: 2rem;
}

.variant-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.variant-options {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
}

.variant-option {
    flex: 1;
    position: relative;
}

.variant-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    margin: 0;
    cursor: pointer;
}

.variant-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1.5rem;
    background: var(--card-bg);
    border: 2px solid var(--border-color);
    border-radius: 12px;
    transition: all 0.3s ease;
    cursor: pointer;
    text-align: center;
}

.variant-option input[type="radio"]:checked + .variant-label {
    border-color: var(--primary-color);
    background: rgba(74, 144, 226, 0.1);
}

.variant-label:hover {
    border-color: var(--primary-color);
}

.variant-name {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.variant-price {
    color: var(--primary-color);
    font-weight: 700;
    font-size: 1.1rem;
}

.discount-section {
    margin-bottom: 2rem;
}

.discount-input {
    width: 100%;
    padding: 1rem;
    background: var(--card-bg);
    border: 2px solid var(--border-color);
    border-radius: 10px;
    color: var(--text-primary);
    font-size: 1rem;
    transition: all 0.3s ease;
}

.discount-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
}

.product-actions {
    display: flex;
    gap: 1rem;
    margin-top: auto;
}

.btn-product-modal {
    flex: 1;
    padding: 1.2rem; /* zmniejszone z 1.5rem */
    border-radius: 10px; /* zmniejszone z 12px */
    font-weight: 700;
    font-size: 1rem; /* zmniejszone z 1.1rem */
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn-purchase {
    background: var(--primary-gradient);
    color: white;
}

.btn-purchase:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(74, 144, 226, 0.4);
}

.btn-cart {
    background: transparent;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
}

.btn-cart:hover {
    background: var(--primary-color);
    color: white;
}

/* Cart Modal */
.cart-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.cart-modal.active {
    opacity: 1;
    visibility: visible;
}

.cart-modal-content {
    background: var(--dark-bg);
    border: 2px solid var(--primary-color);
    border-radius: 20px;
    width: 95%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    transform: translateY(-20px) scale(0.95);
    transition: all 0.3s ease;
    padding: 3rem;
}

.cart-modal.active .cart-modal-content {
    transform: translateY(0) scale(1);
}

.cart-title {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--text-primary);
    margin-bottom: 2rem;
    text-align: center;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.cart-items {
    margin-bottom: 2rem;
}

.cart-item {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    padding: 1.5rem;
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    margin-bottom: 1rem;
}

.cart-item-image {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    overflow: hidden;
    flex-shrink: 0;
}

.cart-item-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.cart-item-details {
    flex: 1;
}

.cart-item-name {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.cart-item-variant {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
}

.cart-item-price {
    color: var(--primary-color);
    font-weight: 700;
    font-size: 1.1rem;
}

.cart-item-remove {
    background: var(--error-color);
    border: none;
    border-radius: 8px;
    color: white;
    width: 40px;
    height: 40px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.cart-item-remove:hover {
    transform: scale(1.1);
}

.cart-total {
    background: var(--card-bg);
    border: 2px solid var(--primary-color);
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    text-align: center;
}

.cart-total-label {
    color: var(--text-secondary);
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
}

.cart-total-amount {
    color: var(--primary-color);
    font-size: 2rem;
    font-weight: 800;
}

.cart-actions {
    display: flex;
    gap: 1rem;
}

.cart-empty {
    text-align: center;
    padding: 3rem;
    color: var(--text-muted);
}

.cart-empty i {
    font-size: 4rem;
    margin-bottom: 1rem;
    color: var(--text-muted);
}

/* Cart Button in Navbar */
.cart-button {
    position: relative;
    background: transparent;
    border: 2px solid var(--primary-color);
    border-radius: 6px; /* Zmienione z 8px na 6px jak login */
    color: var(--primary-color);
    width: auto; /* Zmienione z 45px */
    height: 40px; /* Zmienione z 45px */
    padding: 0.75rem 1.5rem; /* Takie samo jak btn */
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem; /* Takie samo jak btn */
    font-weight: 600; /* Takie samo jak btn */
}

.cart-button:hover {
    background: var(--primary-color);
    color: white;
}

.cart-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--error-color);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    font-weight: 600;
}

/* Responsive */
@media (max-width: 768px) {
    .product-modal-content {
        grid-template-columns: 1fr;
        gap: 2rem;
        padding: 2rem;
        margin: 1rem;
    }
    
    .variant-options {
        flex-direction: column;
    }
    
    .product-actions {
        flex-direction: column;
    }
    
    .cart-actions {
        flex-direction: column;
    }
}


/* Animacja checkmark */
.success-animation {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10004;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.success-animation.active {
    opacity: 1;
    visibility: visible;
}

.checkmark-container {
    background: var(--dark-bg);
    border: 3px solid var(--success-color);
    border-radius: 50%;
    width: 150px;
    height: 150px;
    display: flex;
    justify-content: center;
    align-items: center;
    animation: checkmarkPop 0.6s ease-out;
}

.checkmark {
    font-size: 4rem;
    color: var(--success-color);
    animation: checkmarkScale 0.8s ease-out 0.2s both;
}

@keyframes checkmarkPop {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

@keyframes checkmarkScale {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    50% {
        transform: scale(1.3);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

/* Pending status */
.pending-status {
    text-align: center;
    padding: 3rem 2rem;
}

.pending-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--success-color);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.pending-message {
    color: var(--text-secondary);
    font-size: 1rem;
    line-height: 1.5;
    margin-bottom: 2rem;
}

.customer-panel-btn {
    background: var(--primary-gradient);
    border: none;
    border-radius: 10px;
    color: white;
    padding: 1rem 2rem;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
}

.customer-panel-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.4);
}

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 2rem;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 4px;
        }

        .auth-tab {
            flex: 1;
            padding: 0.75rem;
            text-align: center;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .auth-tab.active {
            background: var(--primary-gradient);
            color: white;
        }

        .user-panel {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--dark-bg);
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            min-width: 200px;
            padding: 0.5rem 0;
            margin-top: 0.5rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .user-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            text-decoration: none;
            transition: background 0.3s ease;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
        }

        .dropdown-item:hover {
            background: rgba(74, 144, 226, 0.1);
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            border-top: 2px solid var(--primary-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Hide elements initially */
        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .search-input {
                width: 200px;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .product-card {
                min-width: auto;
            }

            .portfolio-gallery {
                grid-template-columns: 1fr;
            }
        }

        /* sukces animation */
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-in {
            animation: fadeInScale 0.3s ease-out;
        }

        .dropdown-item i.fa-shield-alt {
    color: #f59e0b;
}

.dropdown-item:hover i.fa-shield-alt {
    color: white;
}


/* Order Details Modal */
.order-details-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10001;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.order-details-modal.active {
    opacity: 1;
    visibility: visible;
}

.order-details-content {
    background: var(--dark-bg);
    border: 2px solid var(--primary-color);
    border-radius: 20px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    transform: translateY(-20px) scale(0.95);
    transition: all 0.3s ease;
    padding: 3rem;
}

.order-details-modal.active .order-details-content {
    transform: translateY(0) scale(1);
}

.order-summary-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

.order-summary-section h3 {
    color: var(--text-primary);
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
}

.order-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 0;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-secondary);
}

.order-item:last-child {
    border-bottom: none;
}

.order-item span:last-child {
    color: var(--primary-color);
    font-weight: 600;
}

.total-price {
    text-align: right;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 2px solid var(--primary-color);
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--text-primary);
}

.total-price span {
    color: var(--primary-color);
    font-size: 1.3rem;
}

.server-info-section,
.delivery-requirements-section,
.file-upload-section {
    background: var(--card-bg);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

.server-info-section h3,
.delivery-requirements-section h3,
.file-upload-section h3 {
    color: var(--text-primary);
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
}

.file-upload-section p {
    color: var(--text-secondary);
    margin-bottom: 1rem;
    font-size: 0.9rem;
}

.file-upload-area {
    border: 2px dashed var(--border-color);
    border-radius: 8px;
    padding: 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: var(--dark-bg);
}

.file-upload-area:hover {
    border-color: var(--primary-color);
    background: rgba(74, 144, 226, 0.05);
}

.file-upload-area i {
    font-size: 2rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.file-upload-area p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 0.9rem;
}

.uploaded-files-preview {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.file-preview-item {
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
    position: relative;
    transition: all 0.3s ease;
}

.file-preview-item:hover {
    border-color: var(--primary-color);
}

.file-preview-item i {
    font-size: 1.5rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

.file-preview-item span {
    display: block;
    color: var(--text-secondary);
    font-size: 0.8rem;
    word-break: break-word;
    margin-bottom: 0.5rem;
}

.file-preview-item button {
    position: absolute;
    top: -5px;
    right: -5px;
    background: var(--error-color);
    color: white;
    border: none;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    cursor: pointer;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

.file-preview-item button:hover {
    transform: scale(1.1);
}

/* Responsive */
@media (max-width: 768px) {
    .order-details-content {
        width: 95%;
        padding: 2rem;
        margin: 1rem;
    }
    
    .uploaded-files-preview {
        grid-template-columns: 1fr;
    }
    
    .file-upload-area {
        padding: 1.5rem;
    }
    
    .order-summary-section,
    .server-info-section,
    .delivery-requirements-section,
    .file-upload-section {
        padding: 1rem;
    }
}

.service-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.service-name {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.service-variant {
    font-size: 0.75rem;
    color: var(--text-secondary);
    font-style: italic;
    opacity: 0.8;
}

.variant-badge {
    display: inline-block;
    background: var(--primary-color);
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    margin-left: 0.5rem;
}

.variant-badge.static {
    background: #22c55e;
}

.variant-badge.dynamic {
    background: #f59e0b;
}

.variant-badge.mixed {
    background: #8b5cf6;
}

/* Quantity Section */
.quantity-section {
    margin-bottom: 2rem;
}

.quantity-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.quantity-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
    background: var(--card-bg);
    border: 2px solid var(--border-color);
    border-radius: 12px;
    padding: 1rem;
    transition: all 0.3s ease;
}

.quantity-controls:focus-within {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
}

.quantity-btn {
    background: var(--primary-gradient);
    border: none;
    border-radius: 8px;
    color: white;
    width: 40px;
    height: 40px;
    cursor: pointer;
    font-size: 1.2rem;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.quantity-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 15px rgba(74, 144, 226, 0.4);
}

.quantity-btn:disabled {
    background: var(--text-muted);
    cursor: not-allowed;
    transform: none;
}

.quantity-input {
    width: 80px;
    text-align: center;
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0.75rem;
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 600;
}

.quantity-label {
    color: var(--text-secondary);
    font-weight: 500;
    font-size: 1rem;
}

.quantity-total {
    margin-left: auto;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
}

.quantity-total-label {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
}

.quantity-total-price {
    color: var(--primary-color);
    font-size: 1.3rem;
    font-weight: 700;
}

/* ✅ DODAJ te style do sekcji <style> w index.html */

/* Discount input styling */
.discount-input {
    transition: all 0.3s ease;
    position: relative;
}

.discount-input:focus {
    outline: none;
    border-color: var(--primary-color) !important;
    box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
}

.discount-input.valid {
    border-color: #22c55e !important;
    color: #22c55e !important;
    background: rgba(34, 197, 94, 0.05);
}

.discount-input.invalid {
    border-color: #ef4444 !important;
    color: #ef4444 !important;
    background: rgba(239, 68, 68, 0.05);
}

/* Discount display container */
.discount-display {
    margin-top: 1rem;
    padding: 1rem;
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
    border: 1px solid #22c55e;
    border-radius: 8px;
    animation: slideInDiscount 0.3s ease-out;
}

@keyframes slideInDiscount {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.discount-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.discount-code-badge {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #22c55e;
    font-weight: 600;
    font-size: 0.9rem;
}

.discount-remove-btn {
    background: none;
    border: none;
    color: #ef4444;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 4px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.discount-remove-btn:hover {
    background: rgba(239, 68, 68, 0.1);
    transform: scale(1.1);
}

.discount-savings {
    display: flex;
    justify-content: space-between;
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
}

.discount-amount {
    display: flex;
    justify-content: space-between;
    color: #22c55e;
    font-weight: 600;
    font-size: 0.95rem;
}

.discount-original-price {
    text-decoration: line-through;
    opacity: 0.8;
}

/* Discount notification messages */
.discount-message {
    position: absolute;
    top: -35px;
    left: 0;
    right: 0;
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    font-size: 0.8rem;
    font-weight: 600;
    text-align: center;
    z-index: 1000;
    animation: slideInMessage 0.3s ease-out;
}

.discount-message.success {
    background: #22c55e;
    color: white;
    box-shadow: 0 2px 8px rgba(34, 197, 94, 0.3);
}

.discount-message.error {
    background: #ef4444;
    color: white;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
}

@keyframes slideInMessage {
    from {
        opacity: 0;
        transform: translateY(-5px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Discount section styling improvements */
.discount-section {
    position: relative;
}

.discount-section .form-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-primary);
    font-weight: 600;
}

.discount-section .form-label i {
    color: var(--primary-color);
}

/* Enhanced cart item discount display */
.cart-item-discount {
    color: #22c55e;
    font-size: 0.8rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-top: 0.25rem;
}

.cart-item-original-price {
    text-decoration: line-through;
    opacity: 0.6;
    margin-right: 0.5rem;
}

/* Discount indicator in price summary */
.price-row.discount {
    color: #22c55e;
    font-weight: 600;
    border-top: 1px solid rgba(34, 197, 94, 0.2);
    padding-top: 0.5rem;
    margin-top: 0.5rem;
}

.price-row.discount .price-value {
    color: #22c55e;
}

/* Loading state for discount validation */
.discount-input.loading {
    background-image: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.1), transparent);
    background-size: 200% 100%;
    animation: discountLoading 1.5s infinite;
}

@keyframes discountLoading {
    0% {
        background-position: -200% 0;
    }
    100% {
        background-position: 200% 0;
    }
}

/* Discount success icon animation */
.discount-success-icon {
    color: #22c55e;
    animation: successPulse 0.6s ease-in-out;
}

@keyframes successPulse {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.2);
    }
    100% {
        transform: scale(1);
    }
}

/* Enhanced discount input placeholder */
.discount-input::placeholder {
    color: var(--text-muted);
    font-style: italic;
}

.discount-input:focus::placeholder {
    color: transparent;
}

/* Responsive discount display */
@media (max-width: 768px) {
    .discount-display {
        padding: 0.75rem;
        font-size: 0.85rem;
    }
    
    .discount-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .discount-code-badge {
        font-size: 0.8rem;
    }
    
    .discount-savings,
    .discount-amount {
        font-size: 0.8rem;
    }
}

/* Admin Portfolio Controls */
.admin-portfolio-controls {
    display: none;
    background: var(--card-bg);
    border: 2px solid var(--warning-color);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 2rem;
}

.admin-portfolio-controls.visible {
    display: block;
}

.admin-controls-title {
    color: var(--warning-color);
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.admin-add-form {
    display: grid;
    grid-template-columns: 1fr auto auto;
    gap: 1rem;
    align-items: end;
}

.admin-input {
    padding: 0.75rem;
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.admin-select {
    padding: 0.75rem;
    background: var(--dark-bg);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 0.9rem;
    min-width: 120px;
}

.admin-btn {
    padding: 0.75rem 1.5rem;
    background: var(--warning-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.admin-btn:hover {
    background: #d97706;
    transform: translateY(-2px);
}

.portfolio-item-admin-controls {
    position: absolute;
    top: 5px;
    right: 5px;
    display: none;
    background: rgba(239, 68, 68, 0.9);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 10;
}

.portfolio-item-admin-controls:hover {
    background: rgba(239, 68, 68, 1);
    transform: scale(1.1);
}

.portfolio-item-admin-controls i {
    color: white;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
}

.admin-mode .portfolio-item-admin-controls {
    display: flex;
}

@media (max-width: 768px) {
    .admin-add-form {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
}

    </style>
</head>
<body>
    <!-- Header kurwo-->
    <header class="header" id="header">
        <nav class="nav-container">
            <a href="index.html" class="logo">
                <img src="https://i.imgur.com/ZD3BSRn.png" alt="Graphics Studio Logo">
            </a>
<ul class="nav-menu">
    <li>
        <a href="#home" class="nav-link active"> 
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            Home
        </a>
    </li>
    <li>
        <a href="#products" class="nav-link">
            <svg class="nav-icon" viewBox="0 0 24 24">
                <path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12L8.1 13h7.45c.75 0 1.41-.41 1.75-1.03L21.7 4H5.21l-.94-2H1zm16 16c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            Products
        </a>
    </li>
    <li>
        <a href="#portfolio" class="nav-link" id="portfolioNavBtn">
            <i class="fas fa-images"></i>
            Portfolio
        </a>
    </li>
    <li>
        <a href="/reviews" class="nav-link">
            <i class="fas fa-star"></i>
            Reviews
        </a>
    </li>
    <li>
        <a href="#" class="nav-link">
            <i class="fas fa-gift"></i>
            Rewards
        </a>
    </li>
    <li>
        <a href="https://discord.gg/syncstudio" class="nav-link" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-discord"></i>
            Discord
        </a>
    </li>
</ul>
            
<div class="auth-buttons">
    <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="text" class="search-input" placeholder="Search products..." id="searchInput">
    </div>
    
    <!-- Not logged in -->
    <div id="loginButtons">
        <button class="btn btn-primary" id="loginBtn">Login</button>
        <button class="cart-button" id="cartBtn">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-badge hidden" id="cartBadge">0</span>
        </button>
    </div>
    
    <!-- Logged in -->
    <div id="userPanel" class="user-panel hidden">
        <button class="cart-button" id="cartBtnLoggedIn">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-badge hidden" id="cartBadgeLoggedIn">0</span>
        </button>
        <div class="user-avatar" id="userAvatar">U</div>
        <span id="username">User</span>
        <button id="userDropdownBtn" style="background: none; border: none; color: var(--text-muted); cursor: pointer;">
            <i class="fas fa-chevron-down"></i>
        </button>
        <div class="user-dropdown" id="userDropdown">
            <button class="dropdown-item" id="customerPanelBtn">
                <i class="fas fa-user-cog"></i>
                Customer Panel
            </button>
            <button class="dropdown-item" id="dailyRewardBtn">
                <i class="fas fa-gift"></i>
                Daily Reward
            </button>
            <button class="dropdown-item" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </button>
        </div>
    </div>
</div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1 class="hero-title">Graphics Studio</h1>
            <p class="hero-subtitle">Premium Design Services Since 2023. Transform Your Vision into Stunning Visual Masterpieces.</p>
            <div class="hero-buttons">
                <a href="#products" class="btn btn-primary">
                    <i class="fas fa-shopping-bag"></i>
                    View Products
                </a>
                <a href="#discord" class="btn btn-outline">
                    <i class="fab fa-discord"></i>
                    Discord
                </a>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products-section" id="products">
        <h2 class="section-title">Our Products</h2>
        <p class="section-subtitle">Discover our range of professional design services that will help your brand stand out.</p>
        
        <div class="products-grid" id="productsGrid">
            <!-- Logo Design -->
            <div class="product-card" data-search="logo design branding visual identity">
                <div class="product-image">
                    <img src="https://i.imgur.com/nlCcHCW.jpeg" alt="Logo Design">
                    <div class="product-overlay">
                        <i class="fas fa-paint-brush"></i>
                    </div>
                </div>
                <div class="product-content">
                    <h3 class="product-name">Logo Design</h3>
                    <p class="product-description">
                        Professional logo design that captures your brand's character. Get unique logos in various formats and color variants.
                    </p>
                    <div class="product-price">From $5.99</div>
                    <div class="product-actions">
                        <button class="btn-product btn-product-primary" data-product="logo">
                            <i class="fas fa-shopping-cart"></i>
                            Purchase
                        </button>
                        <button class="btn-product btn-product-outline" data-portfolio="logo">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Banner Design -->
            <div class="product-card" data-search="banner design advertising graphics">
                <div class="product-image">
                    <img src="https://i.imgur.com/zJIFfmA.jpeg" alt="Banner Design">
                    <div class="product-overlay">
                        <i class="fas fa-image"></i>
                    </div>
                </div>
                <div class="product-content">
                    <h3 class="product-name">Banner Design</h3>
                    <p class="product-description">
                        Eye-catching advertising banners for social media, websites and marketing campaigns. High-quality graphics that attract attention.
                    </p>
                    <div class="product-price">From $5.99</div>
                    <div class="product-actions">
                        <button class="btn-product btn-product-primary" data-product="banner">
                            <i class="fas fa-shopping-cart"></i>
                            Purchase
                        </button>
                        <button class="btn-product btn-product-outline" data-portfolio="banner">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Product Box Design -->
            <div class="product-card" data-search="product box packaging design">
                <div class="product-image">
                    <img src="https://i.imgur.com/TvCv2FU.jpeg" alt="Product Box Design">
                    <div class="product-overlay">
                        <i class="fas fa-box"></i>
                    </div>
                </div>
                <div class="product-content">
                    <h3 class="product-name">Product Box Design</h3>
                    <p class="product-description">
                        Professional product packaging designs that will make your products stand out on store shelves. Creative and functional solutions.
                    </p>
                    <div class="product-price">From $3.99</div>
                    <div class="product-actions">
                        <button class="btn-product btn-product-primary" data-product="box">
                            <i class="fas fa-shopping-cart"></i>
                            Purchase
                        </button>
                        <button class="btn-product btn-product-outline" data-portfolio="box">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Thumbnail Design -->
            <div class="product-card" data-search="thumbnail youtube video design">
                <div class="product-image">
                    <img src="https://i.imgur.com/paJN8V4.jpeg" alt="Thumbnail Design">
                    <div class="product-overlay">
                        <i class="fas fa-play-circle"></i>
                    </div>
                </div>
                <div class="product-content">
                    <h3 class="product-name">Thumbnail Design</h3>
                    <p class="product-description">
                        Eye-catching YouTube thumbnails that will increase clicks on your videos. Professional graphics optimized for the platform.
                    </p>
                    <div class="product-price">From $3.99</div>
                    <div class="product-actions">
                        <button class="btn-product btn-product-primary" data-product="thumbnail">
                            <i class="fas fa-shopping-cart"></i>
                            Purchase
                        </button>
                        <button class="btn-product btn-product-outline" data-portfolio="thumbnail">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Branding Portfolio -->
            <div class="product-card" data-search="branding portfolio complete visual identity">
                <div class="product-image">
                    <img src="https://i.imgur.com/8l2YwXB.jpeg" alt="Branding Portfolio">
                    <div class="product-overlay">
                        <i class="fas fa-palette"></i>
                    </div>
                </div>
                <div class="product-content">
                    <h3 class="product-name">Branding Portfolio</h3>
                    <p class="product-description">
                        Complete brand visual identity - logo, business cards, letterhead, colors, fonts and guidelines. Full branding portfolio.
                    </p>
                    <div class="product-price">From $19.99</div>
                    <div class="product-actions">
                        <button class="btn-product btn-product-primary" data-product="branding">
                            <i class="fas fa-shopping-cart"></i>
                            Purchase
                        </button>
                        <button class="btn-product btn-product-outline" data-portfolio="branding">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Benefits Section -->
    <section class="benefits-section">
        <h2 class="section-title">Why Choose Us</h2>
        <p class="section-subtitle">Discover the advantages of working with our professional design team.</p>
        
        <div class="benefits-grid">
            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-rocket"></i>
                </div>
                <h3 class="benefit-title">Fast Delivery</h3>
                <p class="benefit-description">Get your designs delivered within 24-48 hours. We understand the importance of meeting deadlines and work efficiently to deliver quality results quickly.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-crown"></i>
                </div>
                <h3 class="benefit-title">Premium Quality</h3>
                <p class="benefit-description">All designs are created by professional designers with years of experience. We use industry-standard tools and follow best practices to ensure top-quality results.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-sync-alt"></i>
                </div>
                <h3 class="benefit-title">Unlimited Revisions</h3>
                <p class="benefit-description">We offer unlimited revisions until you're 100% satisfied with your design. Your happiness is our priority, and we'll work with you until it's perfect.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-star"></i>
                </div>
                <h3 class="benefit-title">Creative Excellence</h3>
                <p class="benefit-description">Our team delivers innovative and unique designs that stand out from the competition. We focus on creativity and originality in every project.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-headset"></i>
                </div>
                <h3 class="benefit-title">24/7 Support</h3>
                <p class="benefit-description">Our support team is available around the clock to help you with any questions or concerns. Get assistance whenever you need it.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-file-download"></i>
                </div>
                <h3 class="benefit-title">Multiple Formats</h3>
                <p class="benefit-description">Receive your designs in all the formats you need - PNG, JPG, PDF, AI, PSD, and more. Ready for print and digital use right away.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="benefit-title">Dedicated Team</h3>
                <p class="benefit-description">Work directly with experienced designers who understand your vision. Our team is committed to bringing your ideas to life with professional expertise.</p>
            </div>

            <div class="benefit-card">
                <div class="benefit-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3 class="benefit-title">Business Growth</h3>
                <p class="benefit-description">Our designs help boost your brand recognition and business growth. Professional visuals that convert visitors into customers and build trust.</p>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section">
        <h2 class="section-title">Frequently Asked Questions</h2>
        <p class="section-subtitle">Find answers to common questions about our design services.</p>
        
        <div class="faq-container">
            <div class="faq-item">
                <button class="faq-question">
                    How long does it take to complete a design?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>Most designs are completed within 24-48 hours. Complex projects like complete branding packages may take 3-5 business days. We'll provide you with a specific timeline when you place your order.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question">
                    What file formats will I receive?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>You'll receive your designs in multiple formats including PNG (transparent background), JPG, PDF, and source files (AI/PSD) when applicable. All files are print-ready and web-optimized.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question">
                    Do you offer revisions?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>Yes! We offer unlimited revisions until you're completely satisfied with your design. We want to ensure you love the final result and will work with you to make any necessary adjustments.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question">
                    What if I'm not satisfied with the design?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>We offer a 100% money-back guarantee if you're not satisfied with our service. However, with unlimited revisions and our professional team, we're confident you'll love your design.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question">
                    Can I use the designs for commercial purposes?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>Absolutely! All designs come with full commercial rights. You can use them for your business, marketing materials, products, and any other commercial applications without restrictions.</p>
                </div>
            </div>

            <div class="faq-item">
                <button class="faq-question">
                    Do you provide source files?
                    <i class="fas fa-chevron-down faq-icon"></i>
                </button>
                <div class="faq-answer">
                    <p>Yes, source files (AI, PSD, or other native formats) are included with most design packages. This allows you to make future edits or work with other designers if needed.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>Graphics Studio</h3>
                <p>Professional design services since 2023. We transform your vision into stunning visual masterpieces that help your brand stand out.</p>
                <div class="footer-social">
                    <a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" target="_blank"><i class="fab fa-twitter"></i></a>
                    <a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                    <a href="https://discord.gg/graphics" target="_blank"><i class="fab fa-discord"></i></a>
                </div>
            </div>

            <div class="footer-section">
                <h3>Services</h3>
                <ul class="footer-links">
                    <li><a href="#products">Logo Design</a></li>
                    <li><a href="#products">Banner Design</a></li>
                    <li><a href="#products">Product Box Design</a></li>
                    <li><a href="#products">Thumbnail Design</a></li>
                    <li><a href="#products">Complete Branding</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Support</h3>
                <ul class="footer-links">
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="#">Contact Us</a></li>
                    <li><a href="#">Help Center</a></li>
                    <li><a href="#">Order Status</a></li>
                    <li><a href="#">Refund Policy</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Contact</h3>
                <p>Email: nneys.business@gmail.comm</p>
                <p>Discord: Graphics Studio</p>
                <p>Response time: Under 2 hours</p>
                <p>Available 24/7 for support</p>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2023 Graphics Studio. All rights reserved. Made with ❤️ by Varp.</p>
        </div>
    </footer>

    <!-- Support Chat Widget -->
    <div class="chat-widget">
        <button class="chat-button" id="chatButton">
            <i class="fas fa-comments"></i>
        </button>
        
        <div class="chat-panel" id="chatPanel">
            <div class="chat-header">
                <div class="chat-header-icon">
                    <i class="fas fa-headset"></i>
                </div>
                <div class="chat-header-text">
                    <h3>Graphics Support</h3>
                    <p>Online • Usually respond within minutes</p>
                </div>
                <button class="chat-close" id="chatClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="chat-content" id="chatContent">
                <div class="chat-intro">
                    <h4>👋 How can we help you today?</h4>
                    <p>Choose a topic below to get started with our support team.</p>
                </div>
                
                <div class="chat-options" id="chatOptions">
                    <button class="chat-option" data-topic="payment">
                        <div class="chat-option-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                <line x1="1" y1="10" x2="23" y2="10"/>
                            </svg>
                        </div>
                        <div class="chat-option-text">
                            <div class="chat-option-title">Payment Issues</div>
                            <div class="chat-option-desc">Problems with billing, refunds, or transactions</div>
                        </div>
                    </button>
                    
                    <button class="chat-option" data-topic="other">
                        <div class="chat-option-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M9 12l2 2 4-4"/>
                                <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"/>
                                <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
                                <path d="M12 3c0 1-1 3-3 3s-3-2-3-3 1-3 3-3 3 2 3 3"/>
                                <path d="M12 21c0-1 1-3 3-3s3 2 3 3-1 3-3 3-3-2-3-3"/>
                            </svg>
                        </div>
                        <div class="chat-option-text">
                            <div class="chat-option-title">Other Problem</div>
                            <div class="chat-option-desc">Contact support for any other questions</div>
                        </div>
                    </button>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <!-- Messages will be inserted here -->
                </div>
                
                <div class="typing-indicator" id="typingIndicator">
                    <div class="chat-avatar">S</div>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            </div>
            
            <div class="chat-input-area" id="chatInputArea">
                <div class="chat-input-container">
                    <textarea class="chat-input" id="chatInput" placeholder="Type your message..." rows="1"></textarea>
                    <button class="chat-send" id="chatSend">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

   
    <!-- Portfolio Modal -->
    <div class="portfolio-modal" id="portfolioModal">
        <div class="portfolio-content">
            <button class="portfolio-close" id="portfolioClose">
                <i class="fas fa-times"></i>
            </button>
            
            <h2 class="portfolio-title" id="portfolioTitle">Our Portfolio</h2>
            <p class="portfolio-subtitle" id="portfolioSubtitle">Browse our design work by category</p>
            
            <div class="portfolio-tabs">
                <button class="portfolio-tab active" data-category="all">All Work</button>
                <button class="portfolio-tab" data-category="logo">Logos</button>
                <button class="portfolio-tab" data-category="banner">Banners</button>
                <button class="portfolio-tab" data-category="box">Boxes</button>
                <button class="portfolio-tab" data-category="thumbnail">Thumbnails</button>
                <button class="portfolio-tab" data-category="branding">Branding</button>
            </div>
            
            <div class="portfolio-gallery" id="portfolioGallery">
                <!-- Portfolio items will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div class="image-viewer" id="imageViewer">
        <button class="image-viewer-close" id="imageViewerClose">
            <i class="fas fa-times"></i>
        </button>
        <img id="imageViewerImg" src="" alt="">
    </div>

    <!-- Login/Register Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">
                <i class="fas fa-times"></i>
            </button>
            
            <h2 class="modal-title">Welcome to Graphics Studio</h2>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="register">Register</button>
            </div>
            
            <!-- Login Form -->
            <form id="loginForm" class="auth-form">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" placeholder="Enter email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" placeholder="Enter password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="btn-text">Login</span>
                    <div class="loading hidden"></div>
                </button>
            </form>
            
            <!-- Register Form -->
            <form id="registerForm" class="auth-form hidden">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" placeholder="Choose username" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" placeholder="Enter email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" placeholder="Create password" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" class="form-input" placeholder="Confirm password" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="btn-text">Register</span>
                    <div class="loading hidden"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Product Details Modal -->
<div class="product-modal" id="productModal">
    <div class="product-modal-content">
        <button class="product-modal-close" id="productModalClose">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="product-left">
            <div class="product-modal-image">
                <img id="productModalImage" src="" alt="">
            </div>
            <div class="product-modal-description" id="productModalDescription">
                Product description will appear here...
            </div>
        </div>
        
        <div class="product-right">
            <h2 class="product-modal-title" id="productModalTitle">Product Name</h2>
            <div class="product-modal-price" id="productModalPrice">$0.00</div>
            
            <div class="product-variants">
                <h3 class="variant-title">Select Variant</h3>
                <div class="variant-options">
                    <div class="variant-option">
                        <input type="radio" name="variant" value="static" id="variantStatic" checked>
                        <label for="variantStatic" class="variant-label">
                            <span class="variant-name">Static</span>
                            <span class="variant-price" id="staticPrice">$5.99</span>
                        </label>
                    </div>
                    <div class="variant-option">
                        <input type="radio" name="variant" value="dynamic" id="variantDynamic">
                        <label for="variantDynamic" class="variant-label">
                            <span class="variant-name">Dynamic</span>
                            <span class="variant-price" id="dynamicPrice">$9.99</span>
                        </label>
                    </div>
                </div>
            </div>
            
<div class="quantity-section">
    <h3 class="quantity-title">Quantity</h3>
    <div class="quantity-controls">
        <span class="quantity-label">Quantity:</span>
        <button class="quantity-btn" id="decreaseQuantity" type="button">-</button>
        <input type="number" class="quantity-input" id="productQuantity" value="1" min="1" max="99">
        <button class="quantity-btn" id="increaseQuantity" type="button">+</button>
        <div class="quantity-total">
            <span class="quantity-total-label">Total:</span>
            <span class="quantity-total-price" id="quantityTotalPrice">$5.99</span>
        </div>
    </div>
</div>

<div class="discount-section">
    <label class="form-label" for="discountCode">Discount Code (Optional)</label>
    <input type="text" class="discount-input" id="discountCode" placeholder="Enter discount code...">
</div>

            
            
            <div class="product-actions">
                <button class="btn-product-modal btn-purchase" id="purchaseBtn">
                    <i class="fas fa-credit-card"></i>
                    Purchase Now
                </button>
                <button class="btn-product-modal btn-cart" id="addToCartBtn">
                    <i class="fas fa-cart-plus"></i>
                    Add to Cart
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Cart Modal -->
<div class="cart-modal" id="cartModal">
    <div class="cart-modal-content">
        <button class="product-modal-close" id="cartModalClose">
            <i class="fas fa-times"></i>
        </button>
        
        <h2 class="cart-title">
            <i class="fas fa-shopping-cart"></i>
            Your Cart
        </h2>
        
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be inserted here -->
        </div>
        
        <div class="cart-total">
            <div class="cart-total-label">Total Amount:</div>
            <div class="cart-total-amount" id="cartTotalAmount">$0.00</div>
        </div>
        
        <div class="cart-actions">
            <button class="btn-product-modal btn-purchase" id="cartPurchaseBtn">
                <i class="fas fa-credit-card"></i>
                Purchase All
            </button>
            <button class="btn-product-modal btn-cart" id="cartClearBtn">
                <i class="fas fa-trash"></i>
                Clear Cart
            </button>
        </div>
    </div>
</div>


<!-- Payment Modal -->
<div class="payment-modal" id="paymentModal">
  <div class="payment-modal-content">
    <button class="product-modal-close" id="paymentModalClose">
        <i class="fas fa-times"></i>
    </button>
    
    <div class="payment-left">
        <div class="payment-image">
            <img id="paymentImage" src="" alt="">
        </div>
        <div class="payment-description" id="paymentDescription">
            Product description will appear here...
        </div>
        
        <div class="delivery-section">
            <h3 class="section-title">Delivery Date</h3>
            <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1rem;">
                Select your preferred delivery date. Sundays are not available.
            </p>
            
            <div class="calendar-container">
                <div class="calendar-header-nav">
                    <button class="calendar-nav-btn" id="prevMonthBtn">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="calendar-month-year" id="currentMonthYear">
                        26-07-2025
                    </div>
                    <button class="calendar-nav-btn" id="nextMonthBtn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="calendar" id="deliveryCalendar">
                    <!-- Calendar will be generated here -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="payment-right">
        <h2 class="payment-title" id="paymentTitle">Product Name</h2>
        
        <div class="email-section">
            <h3 class="section-title">Email Address</h3>
            <input type="email" class="email-input" id="customerEmail" placeholder="Enter your email address..." required>
        </div>
        
        <div class="discount-section-payment">
            <h3 class="section-title">Discount Code (Optional)</h3>
            <input type="text" class="discount-input-payment" id="paymentDiscountCode" placeholder="Enter discount code...">
        </div>
        
        <div class="payment-method-section">
            <h3 class="section-title">Payment Method</h3>
            <div class="payment-methods">
                <label class="payment-method">
                    <input type="radio" name="paymentMethod" value="stripe">
                    <span class="payment-method-label">Credit / Debit Card</span>
                </label>
                <label class="payment-method">
                    <input type="radio" name="paymentMethod" value="paypal">
                    <span class="payment-method-label">PayPal Friends & Family</span>
                </label>
                <label class="payment-method">
                    <input type="radio" name="paymentMethod" value="bitcoin">
                    <span class="payment-method-label">Crypto [Bitcoin]</span>
                </label>
                <label class="payment-method">
                    <input type="radio" name="paymentMethod" value="litecoin">
                    <span class="payment-method-label">Crypto [Litecoin]</span>
                </label>
                <label class="payment-method">
                    <input type="radio" name="paymentMethod" value="solana">
                    <span class="payment-method-label">Crypto [Solana]</span>
                </label>
            </div>
            
            <!-- Price Summary -->
            <div class="price-summary" id="priceSummary">
                <div class="price-row">
                    <span>Base Price:</span>
                    <span class="price-value" id="basePriceDisplay">$0.00</span>
                </div>
                <div class="price-row" id="deliveryFeeRow" style="display: none;">
                    <span>Delivery Fee:</span>
                    <span class="price-value" id="deliveryFeeDisplay">$0.00</span>
                </div>
                <div class="price-row total">
                    <span>Total:</span>
                    <span class="price-value total" id="totalPriceDisplay">$0.00</span>
                </div>
            </div>
        </div>
        
        <div class="payment-actions">
            <button class="btn-product-modal btn-purchase" id="proceedToPurchase">
                <i class="fas fa-credit-card"></i>
                Purchase Now!
            </button>
        </div>
    </div>
</div>
</div>



<!-- Order Details Modal -->
<div class="order-details-modal" id="orderDetailsModal">
    <div class="order-details-content">
        <button class="product-modal-close" id="orderDetailsClose">
            <i class="fas fa-times"></i>
        </button>
        
        <h2 class="payment-title">Order Details</h2>
        
        <!-- Order Summary -->
        <div class="order-summary-section">
            <h3>Order Summary</h3>
            <div id="orderItemsList">
                <!-- Items będą tu wstawione dynamicznie -->
            </div>
            <div class="total-price">
                Total: <span id="orderModalTotal">$0.00</span>
            </div>
        </div>
        
        <!-- Server Information -->
        <div class="server-info-section">
            <h3>Server Information</h3>
            <input type="text" class="form-input" id="serverName" placeholder="Enter server name..." required>
        </div>
        
        <!-- Delivery Requirements -->
        <div class="delivery-requirements-section">
            <h3>Delivery Requirements</h3>
            <textarea class="form-input" id="deliveryRequirements" placeholder="Describe how you want your graphics to look, style preferences, colors, etc..." rows="4" required></textarea>
        </div>
        
        <!-- File Upload -->
        <div class="file-upload-section">
            <h3>Upload Files (Optional)</h3>
            <p>Upload your logo, reference images, or any other files</p>
            <div class="file-upload-area" id="fileUploadArea">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Click to upload or drag files here</p>
                <input type="file" id="orderFileInput" multiple accept="image/*,.pdf,.doc,.docx,.zip" style="display: none;">
            </div>
            <div class="uploaded-files-preview" id="uploadedFilesPreview"></div>
        </div>
        
        <div class="payment-actions">
            <button class="btn-product-modal btn-purchase" id="applyAndContinue">
                <i class="fas fa-arrow-right"></i>
                Apply & Continue
            </button>
        </div>
    </div>
</div>


<!-- Confirmation Modal -->
<div class="confirmation-modal" id="confirmationModal">
    <div class="confirmation-content">
        <button class="product-modal-close" id="confirmationModalClose">
            <i class="fas fa-times"></i>
        </button>
        
        <h2 class="confirmation-title">Complete Your Payment</h2>
        
        <div class="payment-details">
            <h3 style="color: var(--text-primary); margin-bottom: 1rem;" id="selectedPaymentMethod">Payment Method</h3>
            <div id="paymentInstructions"></div>
            <div class="payment-address" id="paymentAddress"></div>
        </div>
        
        <button class="mark-paid-btn" id="markAsPaidBtn">
            <i class="fas fa-check-circle"></i>
            Mark as Paid
        </button>
    </div>
</div>

<!-- Success Animation -->
<div class="success-animation" id="successAnimation">
    <div class="checkmark-container">
        <i class="fas fa-check checkmark"></i>
    </div>
</div>


    <!-- Firebase Configuration & JavaScript -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBSQNdHH9XAfHyHwWI8iFS2CdsTjv0NMoo",
            authDomain: "authentication-website-c7ab3.firebaseapp.com",
            projectId: "authentication-website-c7ab3",
            storageBucket: "authentication-website-c7ab3.firebasestorage.app",
            messagingSenderId: "380309135971",
            appId: "1:380309135971:web:6e5d75a22f06ff310dce56",
            measurementId: "G-SSKDR565XT"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Portfolio Data
        let isPortfolioAdmin = false;
        let portfolioData = {
            logo: {
                title: "Logo Design Portfolio",
                subtitle: "Professional logo designs for various industries",
                items: [
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/LyuIpoZ.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/vuIZh69.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/ZoY1W8n.png"
                    }
                ]
            },
            banner: {
                title: "Banner Design Portfolio",
                subtitle: "Eye-catching banners for marketing campaigns",
                items: [
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/8fpWmPI.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/ePcECvQ.png"
                    }
                ]
            },
            box: {
                title: "Product Box Portfolio",
                subtitle: "Creative packaging designs that sell",
                items: [
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/IXP5AS9.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/Hxdlcwj.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/KgiMKJj.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/bQSweVQ.png"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/zt8Eaz2.png"
                    }
                ]
            },
            thumbnail: {
                title: "Thumbnail Portfolio",
                subtitle: "Click-worthy YouTube thumbnails",
                items: [
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/9jTuVC3.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/IJze4lK.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/ejonjIW.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/sYFpuO5.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/9lCr7iu.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/ELsaPEo.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/Yb7HyFH.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/XGDbxJS.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/okRRh42.jpeg"
                    }
                ]
            },
            branding: {
                title: "Complete Branding Portfolio",
                subtitle: "Full brand identity solutions",
                items: [
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/8l2YwXB.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/nlCcHCW.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/zJIFfmA.jpeg"
                    },
                    {
                        title: "",
                        description: "",
                        image: "https://i.imgur.com/TvCv2FU.jpeg"
                    }
                ]
            }
        };

        // DOM Elements
        const header = document.getElementById('header');
        const loginBtn = document.getElementById('loginBtn');
        const authModal = document.getElementById('authModal');
        const modalClose = document.getElementById('modalClose');
        const authTabs = document.querySelectorAll('.auth-tab');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');
        const searchInput = document.getElementById('searchInput');
        const productsGrid = document.getElementById('productsGrid');
        const userPanel = document.getElementById('userPanel');
        const loginButtons = document.getElementById('loginButtons');
        const userDropdownBtn = document.getElementById('userDropdownBtn');
        const userDropdown = document.getElementById('userDropdown');
        const logoutBtn = document.getElementById('logoutBtn');
        const portfolioModal = document.getElementById('portfolioModal');
        const portfolioClose = document.getElementById('portfolioClose');
        const portfolioTitle = document.getElementById('portfolioTitle');
        const portfolioSubtitle = document.getElementById('portfolioSubtitle');
        const portfolioGallery = document.getElementById('portfolioGallery');
        const imageViewer = document.getElementById('imageViewer');
        const imageViewerClose = document.getElementById('imageViewerClose');
        const imageViewerImg = document.getElementById('imageViewerImg');

        // Random icons for product hover effect
        const productIcons = [
            'fas fa-paint-brush',
            'fas fa-palette',
            'fas fa-magic',
            'fas fa-star',
            'fas fa-heart',
            'fas fa-thumbs-up',
            'fas fa-gem',
            'fas fa-crown',
            'fas fa-fire',
            'fas fa-bolt',
            'fas fa-sparkles',
            'fas fa-award'
        ];

        // Add random icon hover effect to product cards
        document.querySelectorAll('.product-card').forEach(card => {
            const overlay = card.querySelector('.product-overlay i');
            
            card.addEventListener('mouseenter', () => {
                const randomIcon = productIcons[Math.floor(Math.random() * productIcons.length)];
                overlay.className = randomIcon;
            });
        });

        // FAQ functionality
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const faqItem = question.parentElement;
                const isActive = faqItem.classList.contains('active');
                
                // Close all FAQ items
                document.querySelectorAll('.faq-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Open clicked item if it wasn't active
                if (!isActive) {
                    faqItem.classList.add('active');
                }
            });
        });

        // Support Chat functionality
        const chatButton = document.getElementById('chatButton');
        const chatPanel = document.getElementById('chatPanel');
        const chatClose = document.getElementById('chatClose');
        const chatOptions = document.getElementById('chatOptions');
        const chatMessages = document.getElementById('chatMessages');
        const chatInputArea = document.getElementById('chatInputArea');
        const chatInput = document.getElementById('chatInput');
        const chatSend = document.getElementById('chatSend');
        const typingIndicator = document.getElementById('typingIndicator');
        const chatNotification = document.querySelector('.chat-notification');

        let chatActive = false;
        let selectedTopic = null;
        let messageQueue = [];
        let isTyping = false;

        // Chat responses for different topics
        const chatResponses = {
            payment: [
                "I understand you're looking for license information! 📄",
                "For license details and documentation, please contact our support team on Discord:",
                "🔗 discord.gg/syncstudio",
                "Our team can provide you with all the licensing information you need!"
            ],
            other: [
                "I'd be happy to help you with your question! 🤝",
                "For the best support experience, please reach out to our team on Discord:",
                "🔗 discord.gg/syncstudio", 
                "Our support specialists are active there and can assist you with any questions!"
            ]
        };

        // Simulate typing animation
        async function typeMessage(message, delay = 1500) {
            return new Promise((resolve) => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    addSupportMessage(message);
                    resolve();
                }, delay);
            });
        }

        // Queue messages with delays
        async function sendMessageSequence(messages) {
            if (isTyping) return;
            isTyping = true;
            
            for (let i = 0; i < messages.length; i++) {
                const delay = i === 0 ? 1000 : 2000; // First message faster, others slower
                await typeMessage(messages[i], delay);
                if (i < messages.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 800)); // Pause between messages
                }
            }
            isTyping = false;
        }

        // Open/close chat panel
        chatButton.addEventListener('click', () => {
            chatActive = !chatActive;
            chatPanel.classList.toggle('active', chatActive);
            
            if (chatActive) {
                // Remove notification when chat opens
            }
        });

        chatClose.addEventListener('click', () => {
            chatActive = false;
            chatPanel.classList.remove('active');
        });

        // Handle topic selection
        document.querySelectorAll('.chat-option').forEach(option => {
            option.addEventListener('click', () => {
                selectedTopic = option.dataset.topic;
                showChatMessages(selectedTopic);
            });
        });

        function showChatMessages(topic) {
            chatOptions.style.display = 'none';
            chatMessages.style.display = 'flex';
            
            // Add initial messages for the topic with realistic delays
            const responses = chatResponses[topic];
            sendMessageSequence(responses);
        }

        function addSupportMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';
            const currentTime = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            messageDiv.innerHTML = `
                <div class="chat-avatar">S</div>
                <div>
                    <div class="chat-bubble">${message.replace(/\n/g, '<br>')}</div>
                    <div class="chat-time">${currentTime}</div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addUserMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message';
            messageDiv.style.flexDirection = 'row-reverse';
            messageDiv.innerHTML = `
                <div class="chat-avatar" style="background: #22c55e;">U</div>
                <div class="chat-bubble" style="background: var(--primary-color); border-radius: 15px 15px 5px 15px; margin-left: auto;">${message}</div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTypingIndicator() {
            typingIndicator.style.display = 'flex';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTypingIndicator() {
            typingIndicator.style.display = 'none';
        }

        // Send message functionality
        function sendMessage() {
            const message = chatInput.value.trim();
            if (message) {
                addUserMessage(message);
                chatInput.value = '';
                
                // Simulate support response
                setTimeout(() => {
                    showTypingIndicator();
                    setTimeout(() => {
                        hideTypingIndicator();
                        addSupportMessage("Thank you for your message! Our support team will respond within 2-4 hours. Is there anything else I can help you with? 😊");
                    }, 1500);
                }, 1000);
            }
        }

        chatSend.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Auto-resize textarea
        chatInput.addEventListener('input', () => {
            chatInput.style.height = 'auto';
            chatInput.style.height = Math.min(chatInput.scrollHeight, 120) + 'px';
        });

        // Header scroll effect
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Portfolio Modal Controls
        portfolioClose.addEventListener('click', closePortfolioModal);
        portfolioModal.addEventListener('click', (e) => {
            if (e.target === portfolioModal) closePortfolioModal();
        });

        // Image Viewer Controls
        imageViewerClose.addEventListener('click', closeImageViewer);
        imageViewer.addEventListener('click', (e) => {
            if (e.target === imageViewer) closeImageViewer();
        });

        function openImageViewer(imageSrc) {
            imageViewerImg.src = imageSrc;
            imageViewer.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeImageViewer() {
            imageViewer.classList.remove('active');
            document.body.style.overflow = 'auto';
            setTimeout(() => {
                imageViewerImg.src = '';
            }, 300);
        }

function openPortfolioModal(type = null) {
    document.getElementById('portfolioTitle').textContent = 'Our Portfolio';
    document.getElementById('portfolioSubtitle').textContent = 'Browse our design work by category';
    
    // Load portfolio from Firebase
    loadPortfolioFromFirebase();
    
    initPortfolioTabs();
    setupAdminPortfolioControls();
    
    if (type && portfolioData[type]) {
        const tabs = document.querySelectorAll('.portfolio-tab');
        tabs.forEach(tab => {
            tab.classList.remove('active');
            if (tab.getAttribute('data-category') === type) {
                tab.classList.add('active');
            }
        });
        filterPortfolioItems(type);
    } else {
        const allTab = document.querySelector('.portfolio-tab[data-category="all"]');
        if (allTab) allTab.classList.add('active');
        filterPortfolioItems('all');
    }

    portfolioModal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

        function closePortfolioModal() {
            portfolioModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Portfolio button handlers
        document.addEventListener('click', (e) => {
            if (e.target.hasAttribute('data-portfolio') || e.target.closest('[data-portfolio]')) {
                const btn = e.target.hasAttribute('data-portfolio') ? e.target : e.target.closest('[data-portfolio]');
                const portfolioType = btn.getAttribute('data-portfolio');
                openPortfolioModal(portfolioType);
            }
        });

        // Portfolio tab functionality
        let currentPortfolioData = {};
        
        function initPortfolioTabs() {
            const tabs = document.querySelectorAll('.portfolio-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const category = tab.getAttribute('data-category');
                    filterPortfolioItems(category);
                });
            });
        }

        function filterPortfolioItems(category) {
            const gallery = document.getElementById('portfolioGallery');
            gallery.innerHTML = '';
            
            if (category === 'all') {
                // Show all items from all categories
                Object.values(portfolioData).forEach(categoryData => {
                    categoryData.items.forEach(item => {
                        addPortfolioItem(item);
                    });
                });
            } else {
                // Show items from specific category
                const categoryData = portfolioData[category];
                if (categoryData) {
                    categoryData.items.forEach(item => {
                        addPortfolioItem(item);
                    });
                }
            }
        }

        function addPortfolioItem(item) {
            const portfolioItem = document.createElement('div');
            portfolioItem.className = 'portfolio-item';
            portfolioItem.innerHTML = `
                <img src="${item.image}" alt="Portfolio Item">
                <div class="portfolio-item-overlay" onclick="openImageViewer('${item.image}')">
                    <i class="fas fa-search-plus"></i>
                </div>
            `;
            document.getElementById('portfolioGallery').appendChild(portfolioItem);
        }

        // Auth tab switching
        authTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');
                
                // Update tabs
                authTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update forms
                if (tabName === 'login') {
                    loginForm.classList.remove('hidden');
                    registerForm.classList.add('hidden');
                } else {
                    loginForm.classList.add('hidden');
                    registerForm.classList.remove('hidden');
                }
            });
        });

        // Modal controls
        loginBtn.addEventListener('click', () => {
            authModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });

        modalClose.addEventListener('click', closeAuthModal);
        authModal.addEventListener('click', (e) => {
            if (e.target === authModal) closeAuthModal();
        });

        function closeAuthModal() {
            authModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // User dropdown
        userDropdownBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            userDropdown.classList.toggle('active');
        });

        document.addEventListener('click', () => {
            userDropdown.classList.remove('active');
        });

        // Search functionality for products
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const productCards = document.querySelectorAll('.product-card');
            
            productCards.forEach(card => {
                const searchData = card.getAttribute('data-search') || '';
                const name = card.querySelector('.product-name').textContent.toLowerCase();
                const description = card.querySelector('.product-description').textContent.toLowerCase();
                
                const isMatch = searchData.includes(searchTerm) || 
                               name.includes(searchTerm) || 
                               description.includes(searchTerm);
                
                card.style.display = isMatch ? 'block' : 'none';
            });
        });

        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

// Firebase Auth State Observer z admin check
auth.onAuthStateChanged((user) => {
    if (user) {
        currentUser = user;
        updateUIForLoggedInUser(user);
        
        // ADMIN CHECK - tylko dla varp.administrator@op.pl
        const adminEmails = ['varp.administrator@op.pl'];
        if (adminEmails.includes(user.email)) {
            console.log('Admin detected!'); // DEBUG
            
            // Add admin panel button to dropdown
            const adminBtn = document.createElement('button');
            adminBtn.className = 'dropdown-item';
            adminBtn.id = 'adminPanelBtn';
            adminBtn.innerHTML = `
                <i class="fas fa-shield-alt" style="color: #F7F7FF;"></i>
                Administrator Panel
            `;
            adminBtn.addEventListener('click', () => {
                alert('Admin panel clicked!');
                userDropdown.classList.remove('active');
            });
            
            // Insert AFTER Customer Panel button
            const dropdown = document.getElementById('userDropdown');
            const customerPanelBtn = document.getElementById('customerPanelBtn');
            if (customerPanelBtn) {
                dropdown.insertBefore(adminBtn, customerPanelBtn.nextSibling);
            }
        }
    } else {
        currentUser = null;
        updateUIForLoggedOutUser();
    }
});



function updateUIForLoggedInUser(user) {
    loginButtons.classList.add('hidden');
    userPanel.classList.remove('hidden');
    
    const username = user.displayName || user.email.split('@')[0];
    document.getElementById('username').textContent = username;
    document.getElementById('userAvatar').textContent = username.charAt(0).toUpperCase();
    
    // Check if admin
    isPortfolioAdmin = user.email === 'varp.administrator@op.pl';
    console.log('Portfolio Admin status:', isPortfolioAdmin);
    
    // Add admin panel button if admin
    if (isPortfolioAdmin) {
        const adminBtn = document.createElement('button');
        adminBtn.className = 'dropdown-item';
        adminBtn.id = 'adminPanelBtn';
        adminBtn.innerHTML = `
            <i class="fas fa-shield-alt" style="color: #F7F7FF;"></i>
            Administrator Panel
        `;
        adminBtn.addEventListener('click', () => {
            alert('Admin panel clicked!');
            userDropdown.classList.remove('active');
        });
        
        const dropdown = document.getElementById('userDropdown');
        const customerPanelBtn = document.getElementById('customerPanelBtn');
        if (customerPanelBtn) {
            dropdown.insertBefore(adminBtn, customerPanelBtn.nextSibling);
        }
    }
    
    closeAuthModal();
}

        function updateUIForLoggedOutUser() {
            loginButtons.classList.remove('hidden');
            userPanel.classList.add('hidden');
        }

        // Login Form Handler
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const email = formData.get('email') || e.target.querySelector('input[type="email"]').value;
            const password = formData.get('password') || e.target.querySelector('input[type="password"]').value;
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const btnText = submitBtn.querySelector('.btn-text');
            const loading = submitBtn.querySelector('.loading');
            
            try {
                btnText.classList.add('hidden');
                loading.classList.remove('hidden');
                submitBtn.disabled = true;
                
                await auth.signInWithEmailAndPassword(email, password);
                
                e.target.reset();
                
            } catch (error) {
                console.error('Login error:', error);
                alert('Login error: ' + error.message);
            } finally {
                btnText.classList.remove('hidden');
                loading.classList.add('hidden');
                submitBtn.disabled = false;
            }
        });

        // Register Form Handler
        registerForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const inputs = e.target.querySelectorAll('input');
            const username = inputs[0].value;
            const email = inputs[1].value;
            const password = inputs[2].value;
            const confirmPassword = inputs[3].value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match!');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters!');
                return;
            }
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const btnText = submitBtn.querySelector('.btn-text');
            const loading = submitBtn.querySelector('.loading');
            
            try {
                btnText.classList.add('hidden');
                loading.classList.remove('hidden');
                submitBtn.disabled = true;
                
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                await userCredential.user.updateProfile({
                    displayName: username
                });
                
                await db.collection('users').doc(userCredential.user.uid).set({
                    username: username,
                    email: email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    rewards: []
                });
                
                e.target.reset();
                
            } catch (error) {
                console.error('Registration error:', error);
                alert('Registration error: ' + error.message);
            } finally {
                btnText.classList.remove('hidden');
                loading.classList.add('hidden');
                submitBtn.disabled = false;
            }
        });

        // Logout Handler
        logoutBtn.addEventListener('click', async () => {
            try {
                await auth.signOut();
                userDropdown.classList.remove('active');
            } catch (error) {
                console.error('Logout error:', error);
                alert('Logout error: ' + error.message);
            }
        });

        // Product action handlers
        document.addEventListener('click', (e) => {
            if (e.target.hasAttribute('data-product') || e.target.closest('[data-product]')) {
                const btn = e.target.hasAttribute('data-product') ? e.target : e.target.closest('[data-product]');
                const productType = btn.getAttribute('data-product');
                const productCard = btn.closest('.product-card');
                const productName = productCard.querySelector('.product-name').textContent;
                
                if (!currentUser) {
                    alert('Please login to purchase products!');
                    authModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    return;
                }
                
                alert(`Added "${productName}" to cart!`);
                // Here you would add to cart logic
            }
        });

        // Navigation active state
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= (sectionTop - 200)) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (authModal.classList.contains('active')) {
                    closeAuthModal();
                }
                if (portfolioModal.classList.contains('active')) {
                    closePortfolioModal();
                }
                if (imageViewer.classList.contains('active')) {
                    closeImageViewer();
                }
            }
            
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
            }
        });

        // Add animation on page load
        document.addEventListener('DOMContentLoaded', () => {
            const cards = document.querySelectorAll('.product-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 200);
            });
        });


        // Admin check function
function checkAdminAccess(user) {
    const adminEmails = ['varp.administrator@op.pl'];
    return adminEmails.includes(user.email);
}




document.getElementById('portfolioNavBtn').addEventListener('click', (e) => {
    e.preventDefault();
    openPortfolioModal('all');
});

// Navigation handlers
document.getElementById('customerPanelBtn').addEventListener('click', () => {
    window.location.href = 'customerpanel.html';
});

document.getElementById('dailyRewardBtn').addEventListener('click', () => {
    window.location.href = 'rewards.html';
});



// Cart and Product Modal functionality
let cart = JSON.parse(localStorage.getItem('cart') || '[]');
let currentProduct = null;

const productPrices = {
    logo: { static: 5.99, dynamic: 9.99 },
    banner: { static: 5.99, dynamic: 9.99 },
    box: { static: 3.99, dynamic: 7.99 },
    thumbnail: { static: 3.99, dynamic: 7.99 },
    branding: { static: 19.99, dynamic: 29.99 }
};

const productDescriptions = {
    logo: "Professional logo design that captures your brand's character. Get unique logos in various formats and color variants. Perfect for businesses, startups, and personal brands.",
    banner: "Eye-catching advertising banners for social media, websites and marketing campaigns. High-quality graphics that attract attention and drive engagement.",
    box: "Professional product packaging designs that will make your products stand out on store shelves. Creative and functional solutions for any product type.",
    thumbnail: "Eye-catching YouTube thumbnails that will increase clicks on your videos. Professional graphics optimized for the platform and designed to boost your CTR.",
    branding: "Complete brand visual identity - logo, business cards, letterhead, colors, fonts and guidelines. Full branding portfolio that establishes your professional presence."
};

// Modal elements
const productModal = document.getElementById('productModal');
const productModalClose = document.getElementById('productModalClose');
const cartModal = document.getElementById('cartModal');
const cartModalClose = document.getElementById('cartModalClose');

// Cart buttons
const cartBtn = document.getElementById('cartBtn');
const cartBtnLoggedIn = document.getElementById('cartBtnLoggedIn');
const cartBadge = document.getElementById('cartBadge');
const cartBadgeLoggedIn = document.getElementById('cartBadgeLoggedIn');

// Product modal elements
const productModalImage = document.getElementById('productModalImage');
const productModalTitle = document.getElementById('productModalTitle');
const productModalPrice = document.getElementById('productModalPrice');
const productModalDescription = document.getElementById('productModalDescription');
const staticPrice = document.getElementById('staticPrice');
const dynamicPrice = document.getElementById('dynamicPrice');
const discountCode = document.getElementById('discountCode');
const purchaseBtn = document.getElementById('purchaseBtn');
const addToCartBtn = document.getElementById('addToCartBtn');

// Cart modal elements
const cartItems = document.getElementById('cartItems');
const cartTotalAmount = document.getElementById('cartTotalAmount');
const cartPurchaseBtn = document.getElementById('cartPurchaseBtn');
const cartClearBtn = document.getElementById('cartClearBtn');

// Open product modal
function openProductModal(productType) {
    const productCard = document.querySelector(`[data-product="${productType}"]`).closest('.product-card');
    const productName = productCard.querySelector('.product-name').textContent;
    const productImage = productCard.querySelector('.product-image img').src;
    
    currentProduct = productType;
    
    productModalImage.src = productImage;
    productModalTitle.textContent = productName;
    productModalDescription.textContent = productDescriptions[productType];
    
    const prices = productPrices[productType];
    staticPrice.textContent = `$${prices.static}`;
    dynamicPrice.textContent = `$${prices.dynamic}`;
    productModalPrice.textContent = `From $${prices.static}`;
    
    // Reset form
    document.getElementById('variantStatic').checked = true;
    discountCode.value = '';
    
    productModal.classList.add('active');
    document.body.style.overflow = 'hidden';

    currentQuantity = 1;
document.getElementById('productQuantity').value = 1;
updateProductModalPrice();

}

// Close modals
function closeProductModal() {
    productModal.classList.remove('active');
    document.body.style.overflow = 'auto';
    currentProduct = null;
}

function closeCartModal() {
    cartModal.classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Update cart display
function updateCartDisplay() {
    const itemCount = cart.reduce((total, item) => total + item.quantity, 0);
    
    if (itemCount > 0) {
        cartBadge.textContent = itemCount;
        cartBadge.classList.remove('hidden');
        cartBadgeLoggedIn.textContent = itemCount;
        cartBadgeLoggedIn.classList.remove('hidden');
    } else {
        cartBadge.classList.add('hidden');
        cartBadgeLoggedIn.classList.add('hidden');
    }
    
    // Save to localStorage
    localStorage.setItem('cart', JSON.stringify(cart));
}

// Add to cart
function addToCart() {
    if (!currentProduct) return;
    
    const variant = document.querySelector('input[name="variant"]:checked').value;
    const prices = productPrices[currentProduct];
    const price = prices[variant];
    const productCard = document.querySelector(`[data-product="${currentProduct}"]`).closest('.product-card');
    const productName = productCard.querySelector('.product-name').textContent;
    const productImage = productCard.querySelector('.product-image img').src;
    
    const cartItem = {
        id: `${currentProduct}-${variant}`,
        name: productName,
        type: currentProduct,
        variant: variant,
        price: price,
        image: productImage,
        quantity: currentQuantity,
        discount: discountCode.value || null
    };
    
    // Check if item already exists
    const existingIndex = cart.findIndex(item => item.id === cartItem.id);
    
    if (existingIndex > -1) {
        cart[existingIndex].quantity += 1;
    } else {
        cart.push(cartItem);
    }
    
    updateCartDisplay();
    updateCartModal();
    
    alert('Product added to cart!');
    closeProductModal();
}

// Remove from cart
function removeFromCart(itemId) {
    cart = cart.filter(item => item.id !== itemId);
    updateCartDisplay();
    updateCartModal();
}

// Clear cart
function clearCart() {
    if (confirm('Are you sure you want to clear your cart?')) {
        cart = [];
        updateCartDisplay();
        updateCartModal();
    }
}

// Update cart modal
function updateCartModal() {
    if (cart.length === 0) {
        cartItems.innerHTML = `
            <div class="cart-empty">
                <i class="fas fa-shopping-cart"></i>
                <h3>Your cart is empty</h3>
                <p>Add some products to get started!</p>
            </div>
        `;
        cartTotalAmount.textContent = '$0.00';
        return;
    }
    
// ✅ ZASTĄP mapowanie cart items tym kodem:

cartItems.innerHTML = cart.map(item => `
    <div class="cart-item">
        <div class="cart-item-image">
            <img src="${item.image}" alt="${item.name}">
        </div>
        <div class="cart-item-details">
            <div class="cart-item-name">${item.name}</div>
            <div class="cart-item-variant">${item.variant} variant</div>
            <div class="cart-item-price">
                ${item.discount ? `
                    <span class="cart-item-original-price">$${item.originalPrice}</span>
                ` : ''}
                $${item.price.toFixed(2)} × ${item.quantity}
                ${item.discount ? `
                    <div class="cart-item-discount">
                        <i class="fas fa-tag"></i>
                        ${item.discount.code} applied
                    </div>
                ` : ''}
            </div>
        </div>
        <button class="cart-item-remove" onclick="removeFromCart('${item.id}')">
            <i class="fas fa-trash"></i>
        </button>
    </div>
`).join('');
    
    const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    cartTotalAmount.textContent = `$${total.toFixed(2)}`;
}

// Open cart modal
function openCartModal() {
    updateCartModal();
    cartModal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

// Event listeners
productModalClose.addEventListener('click', closeProductModal);
cartModalClose.addEventListener('click', closeCartModal);

productModal.addEventListener('click', (e) => {
    if (e.target === productModal) closeProductModal();
});

cartModal.addEventListener('click', (e) => {
    if (e.target === cartModal) closeCartModal();
});

cartBtn.addEventListener('click', openCartModal);
cartBtnLoggedIn.addEventListener('click', openCartModal);

addToCartBtn.addEventListener('click', addToCart);
cartClearBtn.addEventListener('click', clearCart);

let currentQuantity = 1;

// Update product modal price when variant changes
document.querySelectorAll('input[name="variant"]').forEach(radio => {
    radio.addEventListener('change', updateProductModalPrice);
});

document.addEventListener('click', (e) => {
    if (e.target.id === 'increaseQuantity') {
        const quantityInput = document.getElementById('productQuantity');
        const newQuantity = Math.min(parseInt(quantityInput.value) + 1, 99);
        quantityInput.value = newQuantity;
        currentQuantity = newQuantity;
        console.log('🔢 Quantity increased to:', currentQuantity); // ✅ DEBUG
        updateProductModalPrice();
    }
    
    if (e.target.id === 'decreaseQuantity') {
        const quantityInput = document.getElementById('productQuantity');
        const newQuantity = Math.max(parseInt(quantityInput.value) - 1, 1);
        quantityInput.value = newQuantity;
        currentQuantity = newQuantity;
        console.log('🔢 Quantity decreased to:', currentQuantity); // ✅ DEBUG
        updateProductModalPrice();
    }

    
});



// Quantity input change
document.addEventListener('change', (e) => {
    if (e.target.id === 'productQuantity') {
        const value = Math.max(1, Math.min(99, parseInt(e.target.value) || 1));
        e.target.value = value;
        currentQuantity = value;
        updateProductModalPrice();
    }
});


function updateProductModalPrice() {
    if (currentProduct) {
        const variant = document.querySelector('input[name="variant"]:checked').value;
        const unitPrice = productPrices[currentProduct][variant];
        const totalPrice = unitPrice * currentQuantity;
        
        productModalPrice.textContent = `$${totalPrice.toFixed(2)}`;
        document.getElementById('quantityTotalPrice').textContent = `$${totalPrice.toFixed(2)}`;
        
        // Update decrease button state
        const decreaseBtn = document.getElementById('decreaseQuantity');
        if (decreaseBtn) {
            decreaseBtn.disabled = currentQuantity <= 1;
        }
        
        // Update payment modal price if it's open and not from cart
        if (paymentModal.classList.contains('active') && !isFromCart) {
            let deliveryFee = 0;
            if (selectedDeliveryDate) {
                const today = new Date();
                const diffTime = Math.abs(selectedDeliveryDate - today);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                if (diffDays === 1) deliveryFee = 1.50;
                else if (diffDays >= 2 && diffDays <= 4) deliveryFee = 0.50;
            }
            updatePriceSummary(totalPrice, deliveryFee, currentQuantity);
        }
    }
}


purchaseBtn.addEventListener('click', () => {
    if (!currentUser) {
        alert('Please login to purchase!');
        closeProductModal();
        authModal.classList.add('active');
        document.body.style.overflow = 'hidden';
        return;
    }
    
    isFromCart = false;
    openPaymentModal(); // WRACAMY DO ORYGINALNEJ FUNKCJI
});

cartPurchaseBtn.addEventListener('click', () => {
    if (!currentUser) {
        alert('Please login to purchase!');
        return;
    }
    
    if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
    }
    
    isFromCart = true;
    openPaymentModal(); // WRACAMY DO ORYGINALNEJ FUNKCJI
});


// Update existing product action handlers
document.addEventListener('click', (e) => {
    if (e.target.hasAttribute('data-product') || e.target.closest('[data-product]')) {
        e.preventDefault();
        const btn = e.target.hasAttribute('data-product') ? e.target : e.target.closest('[data-product]');
        const productType = btn.getAttribute('data-product');
        openProductModal(productType);
    }
});

// Initialize cart display
updateCartDisplay();

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        if (productModal.classList.contains('active')) {
            closeProductModal();
        }
        if (cartModal.classList.contains('active')) {
            closeCartModal();
        }
    }
});


// Payment Modal Variables
const paymentModal = document.getElementById('paymentModal');
const paymentModalClose = document.getElementById('paymentModalClose');
const confirmationModal = document.getElementById('confirmationModal');
const confirmationModalClose = document.getElementById('confirmationModalClose');

let selectedDeliveryDate = null;
let selectedPaymentMethod = null;
let currentOrderData = null;

// Payment addresses
const paymentAddresses = {
    stripe: 'https://buy.stripe.com/fZe5mT3q27xb4qQ9AN',
    paypal: 'scs.harp@paypal.hub.pl',
    bitcoin: 'bc1qr3r8ts4dssvnxkl6twa7lf06l2czc889xftaqx',
    litecoin: 'LV99hZkuoB8rxD7MuoYmdcbfzGuYncy9v9',
    solana: 'DLAFu2wJ7uiWSvdn7ycA8i8DyH8xr3RjP5YnW8NmKamz'
};

// Dodaj na górze z innymi zmiennymi
let isFromCart = false;

let currentOrderDetails = null;
let orderFiles = [];

function openOrderDetailsModal() {
    console.log('🔍 Opening order details modal...');
    
    try {
        // ✅ NAJPIERW USTAW currentOrderData
        if (!currentOrderData) {
            console.log('⚙️ Creating currentOrderData...');
            
            let basePrice, productCount;
            
            if (isFromCart) {
                basePrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                productCount = cart.reduce((total, item) => total + item.quantity, 0);
            } else {
                if (!currentProduct) {
                    console.error('❌ No current product selected');
                    alert('No product selected. Please try again.');
                    return;
                }
                
                const variantElement = document.querySelector('input[name="variant"]:checked');
                if (!variantElement) {
                    console.error('❌ No variant selected');
                    alert('Please select a product variant.');
                    return;
                }
                
                const variant = variantElement.value;
                const unitPrice = productPrices[currentProduct][variant];
                const quantity = currentQuantity || 1;
                basePrice = unitPrice * quantity;
                productCount = quantity;
                
                // Apply discount if available
                if (appliedDiscount) {
                    const calculation = calculateDiscount(basePrice, appliedDiscount);
                    basePrice = calculation.finalPrice;
                }
            }
            
            // Create temporary order data
            currentOrderData = {
                email: currentUser ? currentUser.email : '',
                product: currentProduct,
                basePrice: basePrice,
                productCount: productCount,
                totalPrice: basePrice // Will be updated later with delivery fee
            };
            
            console.log('✅ Created currentOrderData:', currentOrderData);
        }
        
        // Wypełnij order summary
        console.log('📋 Populating order summary...');
        populateOrderSummary();
        
        // Resetuj formularz
        console.log('🔄 Resetting form...');
        document.getElementById('serverName').value = '';
        document.getElementById('deliveryRequirements').value = '';
        orderFiles = [];
        updateOrderFilesPreview();
        
        console.log('✅ Opening modal...');
        document.getElementById('orderDetailsModal').classList.add('active');
        document.body.style.overflow = 'hidden';
        console.log('✅ Order details modal opened successfully');
        
    } catch (error) {
        console.error('❌ Error opening order details modal:', error);
        alert('Error opening order form. Please try again.');
    }
}

function populateOrderSummary() {
    console.log('📋 Populating order summary...');
    console.log('isFromCart:', isFromCart);
    console.log('currentProduct:', currentProduct);
    console.log('cart:', cart);
    
    const orderItemsList = document.getElementById('orderItemsList');
    const orderModalTotal = document.getElementById('orderModalTotal');
    
    if (!orderItemsList || !orderModalTotal) {
        console.error('❌ Order modal elements not found!');
        return;
    }
    
    let items = [];
    let total = 0;
    let productInfo = null;
    
    if (isFromCart) {
        if (!cart || cart.length === 0) {
            console.error('❌ Cart is empty!');
            alert('Cart is empty. Please add products first.');
            return;
        }
        let allProducts = [];
        cart.forEach(item => {
            const itemTotal = item.price * item.quantity;
            
            // ✅ POKAŻ ZNIŻKĘ W ORDER SUMMARY
            let priceDisplay = '';
            if (item.discount && item.originalPrice && item.originalPrice > item.price) {
                const savings = (item.originalPrice - item.price) * item.quantity;
                priceDisplay = `
                    <div style="display: flex; flex-direction: column; align-items: flex-end;">
                        <span style="text-decoration: line-through; color: var(--text-muted); font-size: 0.8rem;">$${(item.originalPrice * item.quantity).toFixed(2)}</span>
                        <span style="color: var(--success-color); font-weight: 600;">$${itemTotal.toFixed(2)} <small>(saved $${savings.toFixed(2)})</small></span>
                    </div>
                `;
            } else {
                priceDisplay = `$${itemTotal.toFixed(2)}`;
            }
            
            items.push(`
                <div class="order-item">
                    <span>
                        ${item.name} ${item.quantity > 1 ? `x${item.quantity}` : ''} (${item.variant})
                        ${item.discount ? `<br><small style="color: var(--success-color);"><i class="fas fa-tag"></i> ${item.discount.code}</small>` : ''}
                    </span>
                    <span>${priceDisplay}</span>
                </div>
            `);
            total += itemTotal;
            
            allProducts.push({
                name: item.name,
                variant: item.variant,
                price: item.price,
                quantity: item.quantity || 1
            });
        });
        
        productInfo = {
            isMultiple: true,
            displayName: `Cart (${cart.length} items)`,
            products: allProducts,
            productsList: allProducts
        };
        
    } else {
        if (!currentProduct) {
            console.error('❌ No current product selected');
            alert('No product selected. Please try again.');
            return;
        }
        
        const variantElement = document.querySelector('input[name="variant"]:checked');
        if (!variantElement) {
            console.error('❌ No variant selected');
            alert('Please select a product variant.');
            return;
        }
        
        const variant = variantElement.value;
        const unitPrice = productPrices[currentProduct][variant];
        const quantity = currentQuantity || 1;
        let totalPrice = unitPrice * quantity;
        let originalPrice = totalPrice;
        
        // ✅ ZASTOSUJ ZNIŻKĘ W ORDER SUMMARY
        if (appliedDiscount) {
            const calculation = calculateDiscount(totalPrice, appliedDiscount);
            totalPrice = calculation.finalPrice;
        }
        
        const productCard = document.querySelector(`[data-product="${currentProduct}"]`).closest('.product-card');
        if (!productCard) {
            console.error('❌ Product card not found for:', currentProduct);
            alert('Product information not found. Please try again.');
            return;
        }
        
        const productName = productCard.querySelector('.product-name').textContent;
        
        // ✅ POKAŻ ZNIŻKĘ W ORDER SUMMARY
        let priceDisplay = '';
        if (appliedDiscount && originalPrice > totalPrice) {
            const savings = originalPrice - totalPrice;
            priceDisplay = `
                <div style="display: flex; flex-direction: column; align-items: flex-end;">
                    <span style="text-decoration: line-through; color: var(--text-muted); font-size: 0.8rem;">$${originalPrice.toFixed(2)}</span>
                    <span style="color: var(--success-color); font-weight: 600;">$${totalPrice.toFixed(2)} <small>(saved $${savings.toFixed(2)})</small></span>
                </div>
            `;
        } else {
            priceDisplay = `$${totalPrice.toFixed(2)}`;
        }
        
        items.push(`
            <div class="order-item">
                <span>
                    ${productName} ${quantity > 1 ? `x${quantity}` : ''} (${variant})
                    ${appliedDiscount ? `<br><small style="color: var(--success-color);"><i class="fas fa-tag"></i> ${appliedDiscount.code}</small>` : ''}
                </span>
                <span>${priceDisplay}</span>
            </div>
        `);
        total = totalPrice;
        
        productInfo = {
            isMultiple: false,
            name: productName,
            variant: variant,
            quantity: quantity,
            displayName: quantity > 1 ? `${productName} x${quantity}` : productName,
            productsList: [{
                name: productName,
                variant: variant,
                quantity: quantity
            }]
        };
    }
    
    // ✅ WYPEŁNIJ UI
    orderItemsList.innerHTML = items.join('');
    orderModalTotal.textContent = `$${total.toFixed(2)}`;
    
    // ✅ ZAPISZ GLOBALNIE
    window.currentOrderProductInfo = productInfo;
    console.log('✅ Product info saved globally:', productInfo);
}


document.getElementById('applyAndContinue').addEventListener('click', async () => {
    const serverName = document.getElementById('serverName').value.trim();
    const requirements = document.getElementById('deliveryRequirements').value.trim();
    
    if (!serverName || !requirements) {
        alert('Please fill in all required fields!');
        return;
    }
    
    console.log('=== APPLY & CONTINUE ===');
    
    try {
        // ✅ ZAPISZ DANE ZAMÓWIENIA
        currentOrderDetails = {
            serverName: serverName,
            requirements: requirements,
            files: orderFiles
        };
        
        // ✅ UTWÓRZ currentOrderData JEŚLI NIE ISTNIEJE
        if (!currentOrderData) {
            let basePrice, productCount;
            
            if (isFromCart) {
                basePrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                productCount = cart.reduce((total, item) => total + item.quantity, 0);
            } else {
                const variant = document.querySelector('input[name="variant"]:checked').value;
                const unitPrice = productPrices[currentProduct][variant];
                const quantity = currentQuantity || 1;
                basePrice = unitPrice * quantity;
                productCount = quantity;
                
                // Apply discount
                if (appliedDiscount) {
                    const calculation = calculateDiscount(basePrice, appliedDiscount);
                    basePrice = calculation.finalPrice;
                }
            }
            
            currentOrderData = {
                email: currentUser ? currentUser.email : '',
                product: currentProduct,
                basePrice: basePrice,
                productCount: productCount,
                totalPrice: basePrice,
                paymentMethod: 'stripe', // Default
                selectedPaymentMethod: 'stripe',
                deliveryDate: new Date(),
                discountCode: appliedDiscount ? appliedDiscount.code : null
            };
        }
        
        console.log('✅ currentOrderData ready:', currentOrderData);
        
        // ✅ ZAMKNIJ ORDER DETAILS I POKAŻ CONFIRMATION
        document.getElementById('orderDetailsModal').classList.remove('active');
        
        setTimeout(() => {
            showConfirmationModal();
        }, 200);
        
    } catch (error) {
        console.error('❌ Error in Apply & Continue:', error);
        alert('Error processing form. Please try again.');
    }
});

// File upload handlers
document.getElementById('fileUploadArea').addEventListener('click', () => {
    document.getElementById('orderFileInput').click();
});

document.getElementById('orderFileInput').addEventListener('change', (e) => {
    const files = Array.from(e.target.files);
    orderFiles = [...orderFiles, ...files];
    updateOrderFilesPreview();
});

function updateOrderFilesPreview() {
    const preview = document.getElementById('uploadedFilesPreview');
    preview.innerHTML = orderFiles.map((file, index) => `
        <div class="file-preview-item">
            <i class="fas fa-file"></i>
            <span>${file.name}</span>
            <button onclick="removeOrderFile(${index})">×</button>
        </div>
    `).join('');
}

function removeOrderFile(index) {
    orderFiles.splice(index, 1);
    updateOrderFilesPreview();
}

// Close handler
document.getElementById('orderDetailsClose').addEventListener('click', () => {
    document.getElementById('orderDetailsModal').classList.remove('active');
    document.body.style.overflow = 'auto';
})


function openPaymentModal() {
    // Reset calendar to current month when opening
    const today = new Date();
    currentCalendarMonth = today.getMonth();
    currentCalendarYear = today.getFullYear();
    
    let productName, productImage, totalBasePrice, productCount;
    
    if (isFromCart) {
        // Dla koszyka
        productName = `Cart (${cart.length} items)`;
        productImage = cart[0] ? cart[0].image : '';
        totalBasePrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        productCount = cart.reduce((total, item) => total + item.quantity, 0);
        document.getElementById('paymentDescription').textContent = `Your cart contains ${cart.length} different products with a total of ${productCount} items.`;
        currentProduct = 'cart';
} else {
    // Dla pojedynczego produktu
    if (!currentProduct) {
        console.error('currentProduct not set!');
        return;
    }
    const productCard = document.querySelector(`[data-product="${currentProduct}"]`).closest('.product-card');
    if (!productCard) {
        console.error('Product card not found!');
        return;
    }
    const quantity = currentQuantity || 1;
    productName = quantity > 1 ? `${productCard.querySelector('.product-name').textContent} x${quantity}` : productCard.querySelector('.product-name').textContent;
    productImage = productCard.querySelector('.product-image img').src;
    const variant = document.querySelector('input[name="variant"]:checked').value;
    const unitPrice = productPrices[currentProduct][variant];
    // Apply discount if available
if (appliedDiscount) {
    const discountCalculation = calculateDiscount(basePrice, appliedDiscount);
    basePrice = discountCalculation.finalPrice;
    if (appliedDiscount.appliedAmount === undefined) {
        appliedDiscount.appliedAmount = discountCalculation.discountAmount;
    }
}
    productCount = quantity;
    document.getElementById('paymentDescription').textContent = productDescriptions[currentProduct];
}
    
    document.getElementById('paymentImage').src = productImage;
    document.getElementById('paymentTitle').textContent = productName;
    
    // Pre-fill email if user is logged in
    if (currentUser) {
        document.getElementById('customerEmail').value = currentUser.email;
    }
    
    generateCalendar();
    setupPaymentMethodHandlers();
    updatePriceSummary(totalBasePrice, 0, productCount);
    
    // Zamknij odpowiedni modal
    if (!isFromCart && productModal.classList.contains('active')) {
        productModal.classList.remove('active');
    } else if (isFromCart && cartModal.classList.contains('active')) {
        cartModal.classList.remove('active');
    }
    
    paymentModal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function openOrderDetailsModal() {
    // Wypełnij order summary
    populateOrderSummary();
    
    // Resetuj formularz
    document.getElementById('serverName').value = '';
    document.getElementById('deliveryRequirements').value = '';
    orderFiles = [];
    updateOrderFilesPreview();
    
    document.getElementById('orderDetailsModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}


// Handler dla Apply & Continue
document.getElementById('applyAndContinue').addEventListener('click', () => {
    const serverName = document.getElementById('serverName').value.trim();
    const requirements = document.getElementById('deliveryRequirements').value.trim();
    
    if (!serverName || !requirements) {
        alert('Please fill in all required fields!');
        return;
    }
    
    // Zapisz dane zamówienia
    currentOrderDetails = {
        serverName: serverName,
        requirements: requirements,
        files: orderFiles
    };
    
    // Zamknij order details i otwórz payment
    document.getElementById('orderDetailsModal').classList.remove('active');
    openPaymentModal();
});

// ✅ ZAKTUALIZUJ funkcję updatePriceSummary - ZNAJDŹ oryginalną i ZASTĄP tym:

function updatePriceSummary(basePrice, deliveryFeePerProduct, productCount = 1) {
    const totalDeliveryFee = deliveryFeePerProduct * productCount;
    let finalBasePrice = basePrice;
    let discountAmount = 0;
    
    // Apply discount if available
    if (appliedDiscount && !isFromCart) {
        const calculation = calculateDiscount(basePrice, appliedDiscount);
        finalBasePrice = calculation.finalPrice;
        discountAmount = calculation.discountAmount;
    }
    
    const totalPrice = finalBasePrice + totalDeliveryFee;
    
    console.log('💰 Price Summary Update:');
    console.log('Original base price:', basePrice);
    console.log('Discount amount:', discountAmount);
    console.log('Final base price:', finalBasePrice);
    console.log('Delivery fee per product:', deliveryFeePerProduct);
    console.log('Product count:', productCount);
    console.log('Total delivery fee:', totalDeliveryFee);
    console.log('Final total price:', totalPrice);
    
    // Get price summary elements
    const priceSummary = document.getElementById('priceSummary');
    const basePriceDisplay = document.getElementById('basePriceDisplay');
    const deliveryFeeRow = document.getElementById('deliveryFeeRow');
    const deliveryFeeDisplay = document.getElementById('deliveryFeeDisplay');
    const totalPriceDisplay = document.getElementById('totalPriceDisplay');
    
    // Clear existing discount row
    const existingDiscountRow = priceSummary.querySelector('.price-row.discount');
    if (existingDiscountRow) {
        existingDiscountRow.remove();
    }
    
    // Update base price
    basePriceDisplay.textContent = `$${basePrice.toFixed(2)}`;
    
    // Add discount row if applicable
    if (discountAmount > 0 && appliedDiscount) {
        const discountRow = document.createElement('div');
        discountRow.className = 'price-row discount';
        discountRow.innerHTML = `
            <span>Discount (${appliedDiscount.code}):</span>
            <span class="price-value">-$${discountAmount.toFixed(2)}</span>
        `;
        
        // Insert before delivery fee or total
        const deliveryRow = document.getElementById('deliveryFeeRow');
        if (deliveryRow && deliveryRow.style.display !== 'none') {
            priceSummary.insertBefore(discountRow, deliveryRow);
        } else {
            const totalRow = priceSummary.querySelector('.price-row.total');
            priceSummary.insertBefore(discountRow, totalRow);
        }
    }
    
    // Update delivery fee
    if (totalDeliveryFee > 0) {
        deliveryFeeDisplay.textContent = `$${totalDeliveryFee.toFixed(2)}`;
        deliveryFeeRow.style.display = 'flex';
    } else {
        deliveryFeeRow.style.display = 'none';
    }
    
    // Update total
    totalPriceDisplay.textContent = `$${totalPrice.toFixed(2)}`;
    
    // Update discount display in payment modal
    if (discountAmount > 0 && appliedDiscount) {
        updateDiscountDisplay('paymentModal', basePrice, discountAmount, finalBasePrice);
    }
}

purchaseBtn.addEventListener('click', () => {
    if (!currentUser) {
        alert('Please login to purchase!');
        closeProductModal();
        authModal.classList.add('active');
        document.body.style.overflow = 'hidden';
        return;
    }
    
    isFromCart = false;
    openOrderDetailsModal(); // ZMIENIONE Z openPaymentModal()
});

cartPurchaseBtn.addEventListener('click', () => {
    if (!currentUser) {
        alert('Please login to purchase!');
        return;
    }
    
    if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
    }
    
    isFromCart = true;
    openOrderDetailsModal(); // ZMIENIONE Z openPaymentModal()
});

// Zaktualizuj variant change handler w product modal
document.querySelectorAll('input[name="variant"]').forEach(radio => {
    radio.addEventListener('change', () => {
        if (currentProduct) {
            const variant = radio.value;
            const price = productPrices[currentProduct][variant];
            productModalPrice.textContent = `$${price}`;
            
            // Update payment modal price if it's open and not from cart
            if (paymentModal.classList.contains('active') && !isFromCart) {
                let deliveryFee = 0;
                if (selectedDeliveryDate) {
                    const today = new Date();
                    const diffTime = Math.abs(selectedDeliveryDate - today);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    if (diffDays === 1) deliveryFee = 1.50;
                    else if (diffDays >= 2 && diffDays <= 4) deliveryFee = 0.50;
                }
                updatePriceSummary(price, deliveryFee, 1);
            }
        }
    });
});

function closePaymentModal() {
    console.log('🔒 Closing payment modal...');
    
    try {
        paymentModal.classList.remove('active');
        document.body.style.overflow = 'auto';
        // ✅ NIE NULLUJ DANYCH - POTRZEBUJEMY ICH W ORDER DETAILS
        // selectedDeliveryDate = null;
        // isFromCart = false;
        // currentProduct = null;
        console.log('✅ Payment modal closed successfully');
    } catch (error) {
        console.error('❌ Error closing payment modal:', error);
    }
}

function closeConfirmationModal() {
    confirmationModal.classList.remove('active');
    document.body.style.overflow = 'auto';
}

let currentCalendarMonth = new Date().getMonth();
let currentCalendarYear = new Date().getFullYear();

// Zaktualizuj generateCalendar
function generateCalendar() {
    const calendar = document.getElementById('deliveryCalendar');
    const monthYearDisplay = document.getElementById('currentMonthYear');
    const prevBtn = document.getElementById('prevMonthBtn');
    const nextBtn = document.getElementById('nextMonthBtn');
    
    // Update month/year display
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'];
    
    const today = new Date();
    const displayDate = `${today.getDate().toString().padStart(2, '0')}-${(today.getMonth() + 1).toString().padStart(2, '0')}-${today.getFullYear()}`;
    monthYearDisplay.textContent = `${displayDate} | ${monthNames[currentCalendarMonth]} ${currentCalendarYear}`;
    
    // Enable/disable navigation buttons
    const currentMonth = today.getMonth();
    const currentYear = today.getFullYear();
    
    if (currentCalendarYear === currentYear && currentCalendarMonth <= currentMonth) {
        prevBtn.disabled = true;
    } else {
        prevBtn.disabled = false;
    }
    
    // Clear calendar
    calendar.innerHTML = '';
    
    // Add headers
    const weekdays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
    weekdays.forEach(day => {
        const header = document.createElement('div');
        header.className = 'calendar-header';
        header.textContent = day;
        calendar.appendChild(header);
    });
    
    // Generate month days
    generateMonthDays(calendar, currentCalendarYear, currentCalendarMonth, today);
    
    // Setup navigation
    setupCalendarNavigation();
}

function generateMonthDays(calendar, year, month, today) {
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    
    // Calculate start date (Monday of the week containing the 1st)
    const startDate = new Date(firstDay);
    const dayOfWeek = firstDay.getDay();
    const daysToSubtract = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
    startDate.setDate(startDate.getDate() - daysToSubtract);
    
    // Generate exactly 42 days (6 weeks)
    for (let i = 0; i < 42; i++) {
        const currentDate = new Date(startDate);
        currentDate.setDate(startDate.getDate() + i);
        
        const dayElement = document.createElement('div');
        dayElement.className = 'calendar-day';
        
        const dayNumber = currentDate.getDate();
        const isCurrentMonth = currentDate.getMonth() === month;
        const isPast = currentDate < today;
        const isSunday = currentDate.getDay() === 0; // 0 = niedziela, 6 = sobota
        
        if (!isCurrentMonth) {
            dayElement.classList.add('other-month');
        }
        
        if (isPast || isSunday) {
            dayElement.classList.add('disabled');
        }
        
        if (isSunday && isCurrentMonth) {
            dayElement.classList.add('sunday');
        }
        
        dayElement.innerHTML = `
            <span>${dayNumber}</span>
            ${isCurrentMonth && !isPast && !isSunday ? getDeliveryPrice(currentDate, today) : ''}
        `;
        
        if (isCurrentMonth && !isPast && !isSunday) {
            dayElement.addEventListener('click', () => selectDeliveryDate(new Date(currentDate), dayElement));
        }
        
        calendar.appendChild(dayElement);
    }
}

function setupCalendarNavigation() {
    const prevBtn = document.getElementById('prevMonthBtn');
    const nextBtn = document.getElementById('nextMonthBtn');
    
    // Remove existing listeners
    prevBtn.replaceWith(prevBtn.cloneNode(true));
    nextBtn.replaceWith(nextBtn.cloneNode(true));
    
    // Get new references
    const newPrevBtn = document.getElementById('prevMonthBtn');
    const newNextBtn = document.getElementById('nextMonthBtn');
    
    newPrevBtn.addEventListener('click', () => {
        if (currentCalendarMonth === 0) {
            currentCalendarMonth = 11;
            currentCalendarYear--;
        } else {
            currentCalendarMonth--;
        }
        generateCalendar();
    });
    
    newNextBtn.addEventListener('click', () => {
        if (currentCalendarMonth === 11) {
            currentCalendarMonth = 0;
            currentCalendarYear++;
        } else {
            currentCalendarMonth++;
        }
        generateCalendar();
    });
}

function selectDeliveryDate(date, element) {
    console.log('=== SELECT DELIVERY DATE ===');
    
    // Remove previous selection
    document.querySelectorAll('.calendar-day.selected').forEach(day => {
        day.classList.remove('selected');
    });
    
    // Add selection to clicked element
    element.classList.add('selected');
selectedDeliveryDate = date;

// DODAJ TO DEBUG:
console.log('CLICKED DATE DETAILS:');
console.log('Month:', date.getMonth() + 1); // +1 bo miesiące są 0-indexed
console.log('Day:', date.getDate());
console.log('Year:', date.getFullYear());
    
    // DEBUGUJ DATY
    const today = new Date();
    console.log('Today ORIGINAL:', today);
    console.log('Selected ORIGINAL:', date);
    
    // Ustaw daty na samo początku dnia
    const todayReset = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const selectedReset = new Date(date.getFullYear(), date.getMonth(), date.getDate());
    
    console.log('Today RESET:', todayReset);
    console.log('Selected RESET:', selectedReset);
    
    const diffTime = selectedReset.getTime() - todayReset.getTime();
    const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));
    
    console.log('Difference in milliseconds:', diffTime);
    console.log('Difference in days:', diffDays);
    
    let deliveryFeePerProduct = 0;
    if (diffDays === 1) {
        deliveryFeePerProduct = 1.50;
        console.log('Applied +$1.50 fee for next day delivery');
    } else if (diffDays >= 2 && diffDays <= 4) {
        deliveryFeePerProduct = 0.50;
        console.log('Applied +$0.50 fee for 2-4 day delivery');
    } else {
        console.log('No delivery fee applied, days difference:', diffDays);
    }
    
    console.log('Final delivery fee per product:', deliveryFeePerProduct);
    
    // Get base price
    const basePriceText = document.getElementById('basePriceDisplay').textContent;
    const basePrice = parseFloat(basePriceText.replace('$', ''));
    const productCount = isFromCart ? cart.reduce((total, item) => total + item.quantity, 0) : 1;
    
    // Update display
    const totalDeliveryFee = deliveryFeePerProduct * productCount;
    const totalPrice = basePrice + totalDeliveryFee;
    
    console.log('Total delivery fee:', totalDeliveryFee);
    console.log('NEW TOTAL PRICE:', totalPrice);
    
    const deliveryFeeRow = document.getElementById('deliveryFeeRow');
    const deliveryFeeDisplay = document.getElementById('deliveryFeeDisplay');
    const totalPriceDisplay = document.getElementById('totalPriceDisplay');
    
    if (totalDeliveryFee > 0) {
        deliveryFeeDisplay.textContent = `$${totalDeliveryFee.toFixed(2)}`;
        deliveryFeeRow.style.display = 'flex';
    } else {
        deliveryFeeRow.style.display = 'none';
    }
    
    totalPriceDisplay.textContent = `$${totalPrice.toFixed(2)}`;
    console.log('Updated total display to:', totalPriceDisplay.textContent);
}


// Popraw getDeliveryPrice
function getDeliveryPrice(date, today) {
    const todayReset = new Date(today);
    todayReset.setHours(0, 0, 0, 0);
    const dateReset = new Date(date);
    dateReset.setHours(0, 0, 0, 0);
    
    const diffTime = dateReset.getTime() - todayReset.getTime();
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    
    if (diffDays === 1) {
        return '<span class="delivery-price">+$1.50</span>';
    } else if (diffDays >= 2 && diffDays <= 4) {
        return '<span class="delivery-price">+$0.50</span>';
    }
    return '';
}

// Payment Method Handlers
function setupPaymentMethodHandlers() {
    document.querySelectorAll('.payment-method').forEach(method => {
        method.addEventListener('click', () => {
            // Remove previous selection
            document.querySelectorAll('.payment-method.selected').forEach(m => {
                m.classList.remove('selected');
            });
            
            // Add selection
            method.classList.add('selected');
            const radio = method.querySelector('input[type="radio"]');
            radio.checked = true;
            selectedPaymentMethod = radio.value;
        });
    });
}

document.getElementById('proceedToPurchase').addEventListener('click', () => {
    console.log('🚀 PURCHASE NOW CLICKED');
    
    try {
        const email = document.getElementById('customerEmail').value;
        const discountCode = document.getElementById('paymentDiscountCode').value;
        
        console.log('📧 Email:', email);
        console.log('📅 Selected delivery date:', selectedDeliveryDate);
        console.log('💳 Selected payment method:', selectedPaymentMethod);
        
        if (!email) {
            alert('Please enter your email address!');
            return;
        }
        
        if (!selectedDeliveryDate) {
            alert('Please select a delivery date!');
            return;
        }
        
        if (!selectedPaymentMethod) {
            alert('Please select a payment method!');
            return;
        }
        
        // ✅ AKTUALIZUJ currentOrderData z danymi płatności
        if (!currentOrderData) {
            console.error('❌ currentOrderData not found, creating new one...');
            // Create basic order data if missing
            let basePrice = 0;
            if (isFromCart) {
                basePrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            } else {
                const variant = document.querySelector('input[name="variant"]:checked').value;
                const unitPrice = productPrices[currentProduct][variant];
                basePrice = unitPrice * currentQuantity;
                if (appliedDiscount) {
                    const calculation = calculateDiscount(basePrice, appliedDiscount);
                    basePrice = calculation.finalPrice;
                }
            }
            
            currentOrderData = {
                basePrice: basePrice,
                productCount: isFromCart ? cart.reduce((total, item) => total + item.quantity, 0) : currentQuantity
            };
        }
        
        // Calculate delivery fee
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const selectedDate = new Date(selectedDeliveryDate);
        selectedDate.setHours(0, 0, 0, 0);
        
        const diffTime = selectedDate.getTime() - today.getTime();
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        
        let deliveryFeePerProduct = 0;
        if (diffDays === 1) {
            deliveryFeePerProduct = 1.50;
        } else if (diffDays >= 2 && diffDays <= 4) {
            deliveryFeePerProduct = 0.50;
        }
        
        const totalDeliveryFee = deliveryFeePerProduct * currentOrderData.productCount;
        const totalPrice = currentOrderData.basePrice + totalDeliveryFee;
        
        // Update currentOrderData
        currentOrderData.email = email;
        currentOrderData.deliveryDate = selectedDeliveryDate;
        currentOrderData.paymentMethod = selectedPaymentMethod;
        currentOrderData.selectedPaymentMethod = selectedPaymentMethod;
        currentOrderData.discountCode = discountCode;
        currentOrderData.deliveryFeePerProduct = deliveryFeePerProduct;
        currentOrderData.totalDeliveryFee = totalDeliveryFee;
        currentOrderData.totalPrice = totalPrice;
        
        console.log('✅ Updated order data:', currentOrderData);
        
        // ZAMKNIJ PAYMENT MODAL I OTWÓRZ CONFIRMATION
        closePaymentModal();
        setTimeout(() => {
            showConfirmationModal();
        }, 100);
        
    } catch (error) {
        console.error('❌ ERROR in proceedToPurchase:', error);
        alert('Error processing your order: ' + error.message + '. Please try again.');
    }
});


function showConfirmationModal() {
    console.log('🔍 Opening confirmation modal...');
    console.log('currentOrderData:', currentOrderData);
    console.log('selectedPaymentMethod:', selectedPaymentMethod);
    
    // ✅ SPRAWDŹ czy currentOrderData istnieje
    if (!currentOrderData) {
        console.error('❌ No order data available - creating basic data');
        
        // Create minimal order data
        currentOrderData = {
            email: currentUser ? currentUser.email : '',
            paymentMethod: 'stripe',
            selectedPaymentMethod: 'stripe',
            basePrice: 0,
            totalPrice: 0,
            productCount: 1
        };
    }
    
    // ✅ RESZTA FUNKCJI BEZ ZMIAN...
    confirmationModal.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    // ✅ POCZEKAJ NA OTWARCIE MODALA
    setTimeout(() => {
        console.log('🔍 Setting up payment details...');
        
        const methodNames = {
            stripe: 'Credit / Debit Card',
            paypal: 'PayPal Friends & Family',
            bitcoin: 'Crypto [Bitcoin]',
            litecoin: 'Crypto [Litecoin]',
            solana: 'Crypto [Solana]'
        };
        
        const paymentMethodElement = document.getElementById('selectedPaymentMethod');
        const instructionsDiv = document.getElementById('paymentInstructions');
        const addressDiv = document.getElementById('paymentAddress');
        
        console.log('🔍 Elements found:');
        console.log('paymentMethodElement:', paymentMethodElement);
        console.log('instructionsDiv:', instructionsDiv);
        console.log('addressDiv:', addressDiv);
        
        if (!paymentMethodElement) {
            console.error('❌ selectedPaymentMethod element not found!');
            alert('Modal setup error. Please try again.');
            closeConfirmationModal();
            return;
        }
        
        if (!instructionsDiv || !addressDiv) {
            console.error('❌ Payment instruction elements not found!');
            alert('Modal setup error. Please try again.');
            closeConfirmationModal();
            return;
        }
        
        const methodToUse = currentOrderData.selectedPaymentMethod || selectedPaymentMethod;
        console.log('🔍 Using payment method:', methodToUse);
        
        paymentMethodElement.textContent = methodNames[methodToUse] || 'Unknown Payment Method';
        
        // ✅ USTAW INSTRUKCJE PŁATNOŚCI
        switch(methodToUse) {
            case 'stripe':
                instructionsDiv.innerHTML = '<p>Click the link below to complete your payment:</p>';
                addressDiv.innerHTML = `<a href="${paymentAddresses.stripe}" target="_blank" style="color: var(--primary-color);">${paymentAddresses.stripe}</a>`;
                break;
            case 'paypal':
                instructionsDiv.innerHTML = '<p>Send the amount as Friends & Family to:</p>';
                addressDiv.innerHTML = `${paymentAddresses.paypal} <button class="copy-button" onclick="copyToClipboard('${paymentAddresses.paypal}')">Copy</button>`;
                break;
            case 'bitcoin':
                instructionsDiv.innerHTML = '<p>Send the exact amount to this Bitcoin address:</p>';
                addressDiv.innerHTML = `${paymentAddresses.bitcoin} <button class="copy-button" onclick="copyToClipboard('${paymentAddresses.bitcoin}')">Copy</button>`;
                break;
            case 'litecoin':
                instructionsDiv.innerHTML = '<p>Send the exact amount to this Litecoin address:</p>';
                addressDiv.innerHTML = `${paymentAddresses.litecoin} <button class="copy-button" onclick="copyToClipboard('${paymentAddresses.litecoin}')">Copy</button>`;
                break;
            case 'solana':
                instructionsDiv.innerHTML = '<p>Send the exact amount to this Solana address:</p>';
                addressDiv.innerHTML = `${paymentAddresses.solana} <button class="copy-button" onclick="copyToClipboard('${paymentAddresses.solana}')">Copy</button>`;
                break;
            default:
                instructionsDiv.innerHTML = '<p>Payment method not recognized. Please contact support.</p>';
                addressDiv.innerHTML = '';
        }
        
        console.log('✅ Confirmation modal setup complete');
        
    }, 100); // 100ms opóźnienie na otwarcie modala
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        alert('Address copied to clipboard!');
    });
}

// Mark as Paid
document.getElementById('markAsPaidBtn').addEventListener('click', () => {
    // Pokaż animację
    showSuccessAnimation();
    
    // Po animacji pokaż pending status
    setTimeout(() => {
        hideSuccessAnimation();
        showPendingStatus();
    }, 2000);
});

function showSuccessAnimation() {
    const successAnimation = document.getElementById('successAnimation');
    successAnimation.classList.add('active');
}

function hideSuccessAnimation() {
    const successAnimation = document.getElementById('successAnimation');
    successAnimation.classList.remove('active');
}

function showPendingStatus() {
    const confirmationContent = document.querySelector('.confirmation-content');
    confirmationContent.innerHTML = `
        <button class="product-modal-close" onclick="closeConfirmationModal()">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="pending-status">
            <h2 class="pending-title">
                <i class="fas fa-clock"></i>
                Payment Pending
            </h2>
            <p class="pending-message">
                Your payment has been marked as complete! We are currently processing your order. 
                You can check your order status and track progress in your Customer Panel.
            </p>
            <button class="customer-panel-btn" onclick="goToCustomerPanel()">
                <i class="fas fa-user-cog"></i>
                Go to Customer Panel
            </button>
        </div>
    `;
    
    // WYWOŁAJ FUNKCJĘ
    savePendingPayment();
}


async function savePendingPayment() {
    if (!currentUser || !currentOrderData) {
        console.error('Missing currentUser or currentOrderData');
        return;
    }
    
    console.log('=== SAVING TO FIREBASE ===');
    console.log('currentOrderDetails:', currentOrderDetails);
    console.log('orderFiles:', orderFiles);
    
let productName = 'Unknown Product';
let productVariant = 'static';
let productsList = []; // ✅ LISTA PRODUKTÓW

// ✅ UŻYJ DANYCH Z ORDER SUMMARY
if (window.currentOrderProductInfo) {
    const info = window.currentOrderProductInfo;
    
    if (info.isMultiple) {
        // ✅ WIELE PRODUKTÓW - ZAPISZ LISTĘ
        productName = info.displayName;
        productVariant = 'mixed';
        productsList = info.productsList || info.products || [];
        console.log('📦 Multiple products from cart:', productsList);
    } else {
        // ✅ JEDEN PRODUKT - POBIERZ AKTUALNĄ ILOŚĆ
        const actualQuantity = currentQuantity || info.quantity || 1;
        productName = info.name;
        productVariant = info.variant;
        productsList = info.productsList || [{
            name: info.name,
            variant: info.variant,
            quantity: actualQuantity
        }];
        console.log('📦 Single product:', productName, productVariant, 'Quantity:', actualQuantity);
    }
} else {
    console.error('❌ No product info found!');
    productName = 'Unknown Product';
    productVariant = 'static';
    productsList = [{
        name: 'Unknown Product',
        variant: 'static',
        quantity: 1
    }];
    console.log('📦 Using fallback product data');
}
    
    // ✅ KONWERTUJ PLIKI DO BASE64
    let uploadedFiles = [];
    if (orderFiles && orderFiles.length > 0) {
        console.log('Converting', orderFiles.length, 'files...');
        for (const file of orderFiles) {
            try {
                const base64Url = await convertFileToBase64(file);
                uploadedFiles.push({
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    url: base64Url
                });
                console.log('✅ Converted:', file.name);
            } catch (error) {
                console.error('❌ Error converting file:', error);
            }
        }
    }
    
const dataToSave = {
    userId: currentUser.uid,
    userEmail: currentUser.email,
    method: currentOrderData.paymentMethod || 'unknown',
    amount: currentOrderData.totalPrice || 0,
    baseAmount: currentOrderData.basePrice || 0,
    deliveryFee: currentOrderData.totalDeliveryFee || 0,
    productName: productName,
    variant: productVariant,
    productsList: productsList, // ✅ LISTA WSZYSTKICH PRODUKTÓW
    deliveryDate: currentOrderData.deliveryDate || null,

    discountCode: appliedDiscount ? appliedDiscount.code : (currentOrderData.discountCode || null),
discountDetails: appliedDiscount ? {
    code: appliedDiscount.code,
    type: appliedDiscount.type,
    value: appliedDiscount.value,
    appliedAmount: appliedDiscount.appliedAmount || 0
} : null,
    
    
    status: 'pending',
    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
    paymentDetails: {
        isFromCart: isFromCart,
        productCount: currentOrderData.productCount || 1
    },
    // Dane z formularza
    serverName: currentOrderDetails?.serverName || null,
    requirements: currentOrderDetails?.requirements || null,
    uploadedFiles: uploadedFiles
};
    
    console.log('📝 Data to save:', dataToSave);
    console.log('📝 Server Name:', dataToSave.serverName);
    console.log('📝 Requirements:', dataToSave.requirements);
    console.log('📝 Files count:', dataToSave.uploadedFiles.length);
    
try {
    const docRef = await db.collection('pending_payments').add(dataToSave);
    console.log('✅ Saved to Firebase with ID:', docRef.id);
    
    // ✅ WYCZYŚĆ KOSZYK TYLKO JEŚLI ZAMÓWIENIE BYŁO Z KOSZYKA
    if (isFromCart) {
        cart = [];
        updateCartDisplay();
        console.log('🛒 Cart cleared after successful order');
    }

    if (appliedDiscount && appliedDiscount.code) {
    await updateDiscountUsage(appliedDiscount.code);
}

// ✅ WYCZYŚĆ ZASTOSOWANĄ ZNIŻKĘ PO UDANYM ZAMÓWIENIU
removeDiscount();

    
    // ✅ WYCZYŚĆ DANE ZAMÓWIENIA
    resetOrderProcess();
    
} catch (error) {
    console.error('❌ Firebase save error:', error);
    alert('Error saving to Firebase: ' + error.message);
}


}

function goToCustomerPanel() {
    window.location.href = 'customerpanel.html';
}

// Modal close handlers
paymentModalClose.addEventListener('click', closePaymentModal);
confirmationModalClose.addEventListener('click', closeConfirmationModal);

paymentModal.addEventListener('click', (e) => {
    if (e.target === paymentModal) closePaymentModal();
});

confirmationModal.addEventListener('click', (e) => {
    if (e.target === confirmationModal) closeConfirmationModal();
});


// Order Details Modal handlers
document.getElementById('orderDetailsClose').addEventListener('click', () => {
    document.getElementById('orderDetailsModal').classList.remove('active');
    document.body.style.overflow = 'auto';
});

document.getElementById('applyAndContinue').addEventListener('click', async () => {
    const serverName = document.getElementById('serverName').value.trim();
    const requirements = document.getElementById('deliveryRequirements').value.trim();
    
    if (!serverName || !requirements) {
        alert('Please fill in all required fields!');
        return;
    }
    
    console.log('=== APPLY & CONTINUE ===');
    console.log('Server Name:', serverName);
    console.log('Requirements:', requirements);
    console.log('Files:', orderFiles);
    
    try {
        // ✅ ZAPISZ DANE ZAMÓWIENIA
        currentOrderDetails = {
            serverName: serverName,
            requirements: requirements,
            files: orderFiles
        };
        
        console.log('Saved currentOrderDetails:', currentOrderDetails);
        
        // ✅ ZAMKNIJ ORDER DETAILS
        document.getElementById('orderDetailsModal').classList.remove('active');
        
        // ✅ POCZEKAJ I POKAŻ CONFIRMATION
        setTimeout(() => {
            showConfirmationModal();
        }, 200);
        
    } catch (error) {
        console.error('❌ Error in Apply & Continue:', error);
        alert('Error processing form. Please try again.');
    }
});

// File upload handler
document.getElementById('fileUploadArea').addEventListener('click', () => {
    document.getElementById('orderFileInput').click();
});

document.getElementById('orderFileInput').addEventListener('change', async (e) => {
    const files = Array.from(e.target.files);
    
    for (const file of files) {
        const base64Url = await convertFileToBase64(file);
        orderFiles.push({
            name: file.name,
            size: file.size,
            type: file.type,
            url: base64Url
        });
    }
    
    updateOrderFilesPreview();
    e.target.value = '';
});


// Konwertuj plik do base64
function convertFileToBase64(file) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
    });
}

function resetOrderProcess() {
    console.log('🔄 Resetting order process...');
    selectedDeliveryDate = null;
    selectedPaymentMethod = null;
    isFromCart = false;
    currentProduct = null;
    currentOrderData = null;
    currentOrderDetails = null;
    orderFiles = [];
    window.currentOrderProductInfo = null;
    
    // Wyczyść koszyk jeśli zamówienie było z koszyka
    if (isFromCart) {
        cart = [];
        updateCartDisplay();
    }
    
    console.log('✅ Order process reset complete');
}


console.log('Current product info:', window.currentOrderProductInfo);


// ✅ DODAJ te funkcje na końcu pliku JavaScript w index.html (przed console.log('🎨 Graphics Studio website loaded successfully!');)

// Discount system variables
let appliedDiscount = null;
let currentDiscountCode = '';

// ✅ 1. FUNKCJA SPRAWDZANIA ZNIŻKI
async function validateDiscountCode(code) {
    if (!code || code.trim() === '') {
        return null;
    }
    
    try {
        console.log('🏷️ Validating discount code:', code);
        
        // Query Firestore for the discount code
        const discountQuery = await db.collection('discounts')
            .where('code', '==', code.toUpperCase())
            .where('isActive', '==', true)
            .get();
        
        if (discountQuery.empty) {
            console.log('❌ Discount code not found or inactive');
            return { error: 'Invalid or expired discount code' };
        }
        
        const discountDoc = discountQuery.docs[0];
        const discount = discountDoc.data();
        
        console.log('🏷️ Found discount:', discount);
        
        // Check if expired
        if (discount.expiryDate && discount.expiryDate.toDate() < new Date()) {
            console.log('❌ Discount code expired');
            return { error: 'This discount code has expired' };
        }
        
        // Check if usage limit reached
        if (discount.usageLimit && discount.usedCount >= discount.usageLimit) {
            console.log('❌ Discount code usage limit reached');
            return { error: 'This discount code has reached its usage limit' };
        }
        
        console.log('✅ Discount code validated successfully');
        return {
            id: discountDoc.id,
            code: discount.code,
            type: discount.type,
            value: discount.value,
            usageLimit: discount.usageLimit,
            usedCount: discount.usedCount
        };
        
    } catch (error) {
        console.error('❌ Error validating discount code:', error);
        return { error: 'Error validating discount code' };
    }
}

// ✅ 2. FUNKCJA OBLICZANIA ZNIŻKI
function calculateDiscount(basePrice, discount) {
    if (!discount || !discount.type || !discount.value) {
        return { discountAmount: 0, finalPrice: basePrice };
    }
    
    let discountAmount = 0;
    
    if (discount.type === 'percentage') {
        discountAmount = (basePrice * discount.value) / 100;
    } else if (discount.type === 'fixed') {
        discountAmount = Math.min(discount.value, basePrice); // Nie może być większa niż cena
    }
    
    const finalPrice = Math.max(0, basePrice - discountAmount);
    
    console.log('💰 Discount calculation:');
    console.log('Base price:', basePrice);
    console.log('Discount type:', discount.type);
    console.log('Discount value:', discount.value);
    console.log('Discount amount:', discountAmount);
    console.log('Final price:', finalPrice);
    
    return { discountAmount, finalPrice };
}

// ✅ 3. AKTUALIZUJ FUNKCJĘ updateProductModalPrice
function updateProductModalPriceWithDiscount() {
    if (currentProduct) {
        const variant = document.querySelector('input[name="variant"]:checked').value;
        const unitPrice = productPrices[currentProduct][variant];
        let totalBasePrice = unitPrice * currentQuantity;
        
        // Apply discount if available
        let finalPrice = totalBasePrice;
        let discountAmount = 0;
        
        if (appliedDiscount) {
            const calculation = calculateDiscount(totalBasePrice, appliedDiscount);
            finalPrice = calculation.finalPrice;
            discountAmount = calculation.discountAmount;
        }
        
        // Update display
        productModalPrice.textContent = `$${finalPrice.toFixed(2)}`;
        document.getElementById('quantityTotalPrice').textContent = `$${finalPrice.toFixed(2)}`;
        
        // Show discount info in product modal
        updateDiscountDisplay('productModal', totalBasePrice, discountAmount, finalPrice);
        
        // Update decrease button state
        const decreaseBtn = document.getElementById('decreaseQuantity');
        if (decreaseBtn) {
            decreaseBtn.disabled = currentQuantity <= 1;
        }
        
        // Update payment modal price if it's open and not from cart
        if (paymentModal.classList.contains('active') && !isFromCart) {
            let deliveryFee = 0;
            if (selectedDeliveryDate) {
                const today = new Date();
                const diffTime = Math.abs(selectedDeliveryDate - today);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                if (diffDays === 1) deliveryFee = 1.50;
                else if (diffDays >= 2 && diffDays <= 4) deliveryFee = 0.50;
            }
            updatePriceSummary(finalPrice, deliveryFee, currentQuantity);
        }
    }
}

// ✅ 4. FUNKCJA WYŚWIETLANIA ZNIŻKI
function updateDiscountDisplay(modalType, basePrice, discountAmount, finalPrice) {
    let discountContainer;
    
    if (modalType === 'productModal') {
        // Find or create discount display in product modal
        discountContainer = document.getElementById('productDiscountDisplay');
        if (!discountContainer) {
            discountContainer = document.createElement('div');
            discountContainer.id = 'productDiscountDisplay';
            discountContainer.style.cssText = `
                margin-top: 1rem;
                padding: 1rem;
                background: rgba(34, 197, 94, 0.1);
                border: 1px solid #22c55e;
                border-radius: 8px;
                display: none;
            `;
            
            // Insert after quantity section
            const quantitySection = document.querySelector('.quantity-section');
            if (quantitySection) {
                quantitySection.parentNode.insertBefore(discountContainer, quantitySection.nextSibling);
            }
        }
    } else if (modalType === 'paymentModal') {
        // Find or create discount display in payment modal
        discountContainer = document.getElementById('paymentDiscountDisplay');
        if (!discountContainer) {
            discountContainer = document.createElement('div');
            discountContainer.id = 'paymentDiscountDisplay';
            discountContainer.style.cssText = `
                margin-top: 1rem;
                padding: 1rem;
                background: rgba(34, 197, 94, 0.1);
                border: 1px solid #22c55e;
                border-radius: 8px;
                display: none;
            `;
            
            // Insert in price summary
            const priceSummary = document.getElementById('priceSummary');
            if (priceSummary) {
                priceSummary.appendChild(discountContainer);
            }
        }
    }
    
    if (!discountContainer) return;
    
    if (discountAmount > 0 && appliedDiscount) {
        const discountType = appliedDiscount.type === 'percentage' ? '%' : '$';
        const discountValue = appliedDiscount.type === 'percentage' ? 
            `${appliedDiscount.value}%` : 
            `$${appliedDiscount.value}`;
        
        discountContainer.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <span style="color: #22c55e; font-weight: 600;">
                    <i class="fas fa-tag"></i> ${appliedDiscount.code} (${discountValue})
                </span>
                <button onclick="removeDiscount()" style="background: none; border: none; color: #ef4444; cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="display: flex; justify-content: space-between; color: var(--text-secondary); font-size: 0.9rem;">
                <span>Original Price:</span>
                <span style="text-decoration: line-through;">$${basePrice.toFixed(2)}</span>
            </div>
            <div style="display: flex; justify-content: space-between; color: #22c55e; font-weight: 600;">
                <span>You Save:</span>
                <span>-$${discountAmount.toFixed(2)}</span>
            </div>
        `;
        discountContainer.style.display = 'block';
    } else {
        discountContainer.style.display = 'none';
    }
}

// ✅ 5. FUNKCJA APLIKOWANIA ZNIŻKI
async function applyDiscountCode(inputElement, modalType = 'productModal') {
    const code = inputElement.value.trim().toUpperCase();
    
    if (!code) {
        appliedDiscount = null;
        currentDiscountCode = '';
        if (modalType === 'productModal') {
            updateProductModalPriceWithDiscount();
        }
        return;
    }
    
    // Show loading state
    const originalPlaceholder = inputElement.placeholder;
    inputElement.placeholder = 'Validating...';
    inputElement.disabled = true;
    
    try {
        const validation = await validateDiscountCode(code);
        
        if (validation && !validation.error) {
            // Valid discount
            appliedDiscount = validation;
            currentDiscountCode = code;
            inputElement.style.borderColor = '#22c55e';
            inputElement.style.color = '#22c55e';
            
            // Show success message briefly
            const successMsg = document.createElement('div');
            successMsg.style.cssText = `
                position: absolute;
                top: -30px;
                left: 0;
                background: #22c55e;
                color: white;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                font-size: 0.8rem;
                z-index: 1000;
            `;
            successMsg.textContent = `${validation.type === 'percentage' ? validation.value + '%' : '$' + validation.value} discount applied!`;
            
            inputElement.parentElement.style.position = 'relative';
            inputElement.parentElement.appendChild(successMsg);
            
            setTimeout(() => {
                if (successMsg.parentElement) {
                    successMsg.remove();
                }
            }, 3000);
            
        } else {
            // Invalid discount
            appliedDiscount = null;
            currentDiscountCode = '';
            inputElement.style.borderColor = '#ef4444';
            inputElement.style.color = '#ef4444';
            
            // Show error message
            const errorMsg = document.createElement('div');
            errorMsg.style.cssText = `
                position: absolute;
                top: -30px;
                left: 0;
                background: #ef4444;
                color: white;
                padding: 0.25rem 0.5rem;
                border-radius: 4px;
                font-size: 0.8rem;
                z-index: 1000;
            `;
            errorMsg.textContent = validation.error || 'Invalid discount code';
            
            inputElement.parentElement.style.position = 'relative';
            inputElement.parentElement.appendChild(errorMsg);
            
            setTimeout(() => {
                if (errorMsg.parentElement) {
                    errorMsg.remove();
                }
                inputElement.style.borderColor = '';
                inputElement.style.color = '';
            }, 3000);
        }
        
        // Update prices
        if (modalType === 'productModal') {
            updateProductModalPriceWithDiscount();
        }
        
    } catch (error) {
        console.error('Error applying discount:', error);
        appliedDiscount = null;
        currentDiscountCode = '';
        inputElement.style.borderColor = '#ef4444';
        alert('Error validating discount code. Please try again.');
    } finally {
        inputElement.placeholder = originalPlaceholder;
        inputElement.disabled = false;
    }
}

// ✅ 6. FUNKCJA USUWANIA ZNIŻKI
function removeDiscount() {
    appliedDiscount = null;
    currentDiscountCode = '';
    
    // Clear input fields
    const productDiscountInput = document.getElementById('discountCode');
    const paymentDiscountInput = document.getElementById('paymentDiscountCode');
    
    if (productDiscountInput) {
        productDiscountInput.value = '';
        productDiscountInput.style.borderColor = '';
        productDiscountInput.style.color = '';
    }
    
    if (paymentDiscountInput) {
        paymentDiscountInput.value = '';
        paymentDiscountInput.style.borderColor = '';
        paymentDiscountInput.style.color = '';
    }
    
    // Update prices
    updateProductModalPriceWithDiscount();
    
    // Hide discount displays
    const productDiscountDisplay = document.getElementById('productDiscountDisplay');
    const paymentDiscountDisplay = document.getElementById('paymentDiscountDisplay');
    
    if (productDiscountDisplay) productDiscountDisplay.style.display = 'none';
    if (paymentDiscountDisplay) paymentDiscountDisplay.style.display = 'none';
}

// ✅ 7. EVENT LISTENERY DLA POLA ZNIŻKI
document.addEventListener('DOMContentLoaded', () => {
    // Product modal discount input
    const productDiscountInput = document.getElementById('discountCode');
    if (productDiscountInput) {
        // Apply discount on Enter key or when input loses focus
        productDiscountInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                applyDiscountCode(productDiscountInput, 'productModal');
            }
        });
        
        productDiscountInput.addEventListener('blur', () => {
            applyDiscountCode(productDiscountInput, 'productModal');
        });
        
        // Clear discount styling when input is cleared
        productDiscountInput.addEventListener('input', (e) => {
            if (e.target.value.trim() === '') {
                e.target.style.borderColor = '';
                e.target.style.color = '';
                removeDiscount();
            }
        });
    }
    
    // Payment modal discount input
    const paymentDiscountInput = document.getElementById('paymentDiscountCode');
    if (paymentDiscountInput) {
        paymentDiscountInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                applyDiscountCode(paymentDiscountInput, 'paymentModal');
            }
        });
        
        paymentDiscountInput.addEventListener('blur', () => {
            applyDiscountCode(paymentDiscountInput, 'paymentModal');
        });
        
        paymentDiscountInput.addEventListener('input', (e) => {
            if (e.target.value.trim() === '') {
                e.target.style.borderColor = '';
                e.target.style.color = '';
                removeDiscount();
            }
        });
    }
});

// ✅ 8. ZASTĄP ORYGINALNĄ FUNKCJĘ updateProductModalPrice
// Znajdź oryginalną funkcję updateProductModalPrice i zastąp ją updateProductModalPriceWithDiscount
const originalUpdateProductModalPrice = updateProductModalPrice;
updateProductModalPrice = updateProductModalPriceWithDiscount;

// ✅ 9. AKTUALIZUJ FUNKCJĘ DODAWANIA DO KOSZYKA
const originalAddToCart = addToCart;
addToCart = function() {
    if (!currentProduct) return;
    
    const variant = document.querySelector('input[name="variant"]:checked').value;
    const prices = productPrices[currentProduct];
    let unitPrice = prices[variant];
    let finalPrice = unitPrice;
    
    // Apply discount to unit price if available
    if (appliedDiscount) {
        const calculation = calculateDiscount(unitPrice, appliedDiscount);
        finalPrice = calculation.finalPrice;
    }
    
    const productCard = document.querySelector(`[data-product="${currentProduct}"]`).closest('.product-card');
    const productName = productCard.querySelector('.product-name').textContent;
    const productImage = productCard.querySelector('.product-image img').src;
    
    const cartItem = {
        id: `${currentProduct}-${variant}`,
        name: productName,
        type: currentProduct,
        variant: variant,
        price: finalPrice, // Use discounted price
        originalPrice: unitPrice, // Keep original price for reference
        image: productImage,
        quantity: currentQuantity,
        discount: appliedDiscount ? {
            code: appliedDiscount.code,
            type: appliedDiscount.type,
            value: appliedDiscount.value
        } : null
    };
    
    // Check if item already exists
    const existingIndex = cart.findIndex(item => item.id === cartItem.id);
    
    if (existingIndex > -1) {
        cart[existingIndex].quantity += currentQuantity;
    } else {
        cart.push(cartItem);
    }
    
    updateCartDisplay();
    updateCartModal();
    
    alert(`Product added to cart with ${appliedDiscount ? appliedDiscount.code + ' discount' : 'no discount'}!`);
    closeProductModal();
    
    // Clear applied discount after adding to cart
    removeDiscount();
};


// ✅ 11. SYNCHRONIZACJA ZNIŻEK MIĘDZY MODALAMI
function syncDiscountBetweenModals() {
    const productDiscountInput = document.getElementById('discountCode');
    const paymentDiscountInput = document.getElementById('paymentDiscountCode');
    
    if (appliedDiscount && currentDiscountCode) {
        if (productDiscountInput) {
            productDiscountInput.value = currentDiscountCode;
            productDiscountInput.style.borderColor = '#22c55e';
            productDiscountInput.style.color = '#22c55e';
        }
        if (paymentDiscountInput) {
            paymentDiscountInput.value = currentDiscountCode;
            paymentDiscountInput.style.borderColor = '#22c55e';
            paymentDiscountInput.style.color = '#22c55e';
        }
    }
}

// ✅ 12. AKTUALIZUJ openPaymentModal ŻEBY SYNCHRONIZOWAĆ ZNIŻKI
const originalOpenPaymentModal = openPaymentModal;
openPaymentModal = function() {
    originalOpenPaymentModal();
    
    // Synchronize discount code
    setTimeout(() => {
        syncDiscountBetweenModals();
        
        // If there's an applied discount, update the payment modal display
        if (appliedDiscount && !isFromCart) {
            const variant = document.querySelector('input[name="variant"]:checked').value;
            const unitPrice = productPrices[currentProduct][variant];
            const totalBasePrice = unitPrice * currentQuantity;
            const calculation = calculateDiscount(totalBasePrice, appliedDiscount);
            
            updateDiscountDisplay('paymentModal', totalBasePrice, calculation.discountAmount, calculation.finalPrice);
            
            // Update price summary with discount
            let deliveryFee = 0;
            if (selectedDeliveryDate) {
                const today = new Date();
                const diffTime = Math.abs(selectedDeliveryDate - today);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                if (diffDays === 1) deliveryFee = 1.50;
                else if (diffDays >= 2 && diffDays <= 4) deliveryFee = 0.50;
            }
            updatePriceSummary(calculation.finalPrice, deliveryFee, currentQuantity);
        }
    }, 100);
};


async function updateDiscountUsage(discountCode) {
    if (!discountCode) return;
    
    try {
        console.log('📊 Updating discount usage for:', discountCode);
        
        const discountQuery = await db.collection('discounts')
            .where('code', '==', discountCode.toUpperCase())
            .get();
        
        if (!discountQuery.empty) {
            const discountDoc = discountQuery.docs[0];
            const currentUsedCount = discountDoc.data().usedCount || 0;
            
            await discountDoc.ref.update({
                usedCount: currentUsedCount + 1
            });
            
            console.log('✅ Discount usage updated successfully');
        }
    } catch (error) {
        console.error('❌ Error updating discount usage:', error);
    }
}

// Check if page loaded with #portfolio hash
window.addEventListener('load', () => {
    if (window.location.hash === '#portfolio') {
        setTimeout(() => {
            openPortfolioModal('all');
        }, 500); // Małe opóźnienie żeby strona się załadowała
    }

});


// Portfolio Firebase functions
async function loadPortfolioFromFirebase() {
    try {
        console.log('📁 Loading portfolio from Firebase...');
        const portfolioDoc = await db.collection('portfolio').doc('data').get();
        
        if (portfolioDoc.exists) {
            const firebaseData = portfolioDoc.data();
            if (firebaseData.portfolioData) {
                portfolioData = firebaseData.portfolioData;
                console.log('✅ Portfolio loaded from Firebase');
            }
        } else {
            console.log('📁 No portfolio data in Firebase, using default');
        }
    } catch (error) {
        console.error('❌ Error loading portfolio:', error);
    }
}

async function savePortfolioToFirebase() {
    try {
        console.log('💾 Saving portfolio to Firebase...');
        await db.collection('portfolio').doc('data').set({
            portfolioData: portfolioData,
            lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
        });
        console.log('✅ Portfolio saved to Firebase');
    } catch (error) {
        console.error('❌ Error saving portfolio:', error);
        alert('Error saving portfolio: ' + error.message);
    }
}

function setupAdminPortfolioControls() {
    if (!isPortfolioAdmin) return;
    
    // Check if controls already exist
    if (document.getElementById('adminPortfolioControls')) return;
    
    const portfolioContent = document.querySelector('.portfolio-content');
    const portfolioTabs = document.querySelector('.portfolio-tabs');
    
    const adminControls = document.createElement('div');
    adminControls.id = 'adminPortfolioControls';
    adminControls.className = 'admin-portfolio-controls visible';
    adminControls.innerHTML = `
        <div class="admin-controls-title">
            <i class="fas fa-tools"></i>
            Portfolio Management (Admin)
        </div>
        <div class="admin-add-form">
            <input type="text" class="admin-input" id="newImageUrl" placeholder="Imgur URL (e.g., https://i.imgur.com/example.jpg)">
            <select class="admin-select" id="newImageCategory">
                <option value="logo">Logo</option>
                <option value="banner">Banner</option>
                <option value="box">Box</option>
                <option value="thumbnail">Thumbnail</option>
                <option value="branding">Branding</option>
            </select>
            <button class="admin-btn" id="addImageBtn">Add Image</button>
        </div>
    `;
    
    portfolioContent.insertBefore(adminControls, portfolioTabs);
    
    // Setup event listeners
    document.getElementById('addImageBtn').addEventListener('click', addPortfolioImage);
    
    // Enable admin mode
    portfolioContent.classList.add('admin-mode');
}

async function addPortfolioImage() {
    const imageUrl = document.getElementById('newImageUrl').value.trim();
    const category = document.getElementById('newImageCategory').value;
    
    if (!imageUrl) {
        alert('Please enter an image URL!');
        return;
    }
    
    // Validate imgur URL
    if (!imageUrl.includes('imgur.com')) {
        alert('Please use an Imgur URL!');
        return;
    }
    
    try {
        // Test if image loads
        const img = new Image();
        img.onload = async () => {
            // Add to portfolio data
            portfolioData[category].items.push({
                title: "",
                description: "",
                image: imageUrl
            });
            
            // Save to Firebase
            await savePortfolioToFirebase();
            
            // Refresh display
            filterPortfolioItems(document.querySelector('.portfolio-tab.active').getAttribute('data-category'));
            
            // Clear input
            document.getElementById('newImageUrl').value = '';
            
            alert('Image added successfully!');
        };
        
        img.onerror = () => {
            alert('Invalid image URL! Please check the link.');
        };
        
        img.src = imageUrl;
        
    } catch (error) {
        console.error('Error adding image:', error);
        alert('Error adding image: ' + error.message);
    }
}

function addPortfolioItem(item, category = null) {
    const portfolioItem = document.createElement('div');
    portfolioItem.className = 'portfolio-item';
    portfolioItem.innerHTML = `
        <img src="${item.image}" alt="Portfolio Item">
        <div class="portfolio-item-overlay" onclick="openImageViewer('${item.image}')">
            <i class="fas fa-search-plus"></i>
        </div>
        ${isPortfolioAdmin ? `
            <div class="portfolio-item-admin-controls" onclick="removePortfolioImage('${item.image}', '${category || 'unknown'}')">
                <i class="fas fa-trash"></i>
            </div>
        ` : ''}
    `;
    document.getElementById('portfolioGallery').appendChild(portfolioItem);
}

async function removePortfolioImage(imageUrl, category) {
    if (!confirm('Are you sure you want to delete this image?')) {
        return;
    }
    
    try {
        // Find and remove from current category or all categories
        if (category && category !== 'unknown' && portfolioData[category]) {
            portfolioData[category].items = portfolioData[category].items.filter(item => item.image !== imageUrl);
        } else {
            // Search all categories
            Object.keys(portfolioData).forEach(cat => {
                portfolioData[cat].items = portfolioData[cat].items.filter(item => item.image !== imageUrl);
            });
        }
        
        // Save to Firebase
        await savePortfolioToFirebase();
        
        // Refresh display
        filterPortfolioItems(document.querySelector('.portfolio-tab.active').getAttribute('data-category'));
        
        alert('Image deleted successfully!');
        
    } catch (error) {
        console.error('Error removing image:', error);
        alert('Error removing image: ' + error.message);
    }
}

function filterPortfolioItems(category) {
    const gallery = document.getElementById('portfolioGallery');
    gallery.innerHTML = '';
    
    if (category === 'all') {
        Object.keys(portfolioData).forEach(cat => {
            portfolioData[cat].items.forEach(item => {
                addPortfolioItem(item, cat);
            });
        });
    } else {
        const categoryData = portfolioData[category];
        if (categoryData) {
            categoryData.items.forEach(item => {
                addPortfolioItem(item, category);
            });
        }
    }
}

console.log('✅ Discount system for products loaded successfully!');



        console.log('🎨 Graphics Studio website loaded successfully!');
    </script>
</body>
</html>